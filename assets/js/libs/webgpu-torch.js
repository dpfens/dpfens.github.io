!function webpackUniversalModuleDefinition(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.torch=n():e.torch=n()}(self,(()=>(()=>{"use strict";var __webpack_modules__={510:function(e,n,r){var o=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.shouldCreateGradient=n.AutoFunction=n.GradientContext=void 0;var i=r(283);function isTensor(e){return e instanceof i.TensorBase}var a=function(){function GradientContext(e){this.savedTensors=[],this.needsInputGradient=e.map((function(e){return isTensor(e)&&e.requiresGrad})),this.inputsWithGradient=e.map((function(e){return isTensor(e)&&e.requiresGrad?e:null}))}return GradientContext.prototype.saveForBackward=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.savedTensors=e},GradientContext}();n.GradientContext=a;var u=function(){function AutoFunction(){}return AutoFunction.forward=function(e){throw new Error("Do not call forward on AutoFunction directly.")},AutoFunction.setupContext=function(e,n,r){throw new Error("Do not call setupContext on AutoFunction directly.")},AutoFunction.backward=function(e,n){throw new Error("Do not call backward on AutoFunction directly.")},AutoFunction.apply=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=new a(e),o=e.map((function(e){return isTensor(e)?e.detach():e})),i=this.forward(o);return this.setupContext(r,o,i),i.setGradientFunction(r,this.backward),i},AutoFunction}();n.AutoFunction=u,n.shouldCreateGradient=function shouldCreateGradient(){for(var e,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{for(var a=o(r),u=a.next();!u.done;u=a.next()){if(u.value.requiresGrad)return!0}}catch(n){e={error:n}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return!1}},955:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Device=void 0;var o=r(610),i=r(521),a=r(621),u=r(473),s=function(){function Device(e,n){this._kernels={},this._id=e,this._type=n}return Object.defineProperty(Device.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(Device.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Device.prototype.allocFor=function(e,n){var r=(0,i.dtypeByteSize)(n),a=(0,o.shapeSize)(e)*r;return this.alloc(a)},Device.prototype.getKernel=function(e,n){var r=u.registry[e];if(void 0===r)throw new Error('Kernel "'.concat(e,'" not found'));var o=(0,a.getKernelConfig)(r,n),i=(0,a.getKernelKey)(r,o),s=this._kernels[i];return void 0===s&&(s=this.createKernel(r,o),this._kernels[i]=s),s},Device}();n.Device=s},514:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)});Object.defineProperty(n,"__esModule",{value:!0}),n.DeviceCPU=void 0;var a=r(955),u=r(912),s=r(891),c=function(e){function DeviceCPU(){return e.call(this,"cpu","cpu")||this}return i(DeviceCPU,e),DeviceCPU.prototype.alloc=function(e){return new u.ArrayBufferStorage(e)},DeviceCPU.prototype.createKernel=function(e,n){return new s.KernelCPU(e,n,this)},DeviceCPU.prototype.getStorageFromKernel=function(e){if(e instanceof Uint8Array||e instanceof Uint32Array||e instanceof Int32Array||e instanceof Float32Array)return new u.ArrayBufferStorage(e.buffer);throw new Error("Cannot wrap buffer of type ".concat(e.constructor.name," to get CPU storage"))},DeviceCPU.prototype.getBufferForKernel=function(e,n){if(e instanceof u.ArrayBufferStorage)return e.getTypedArray(n);throw new Error("Cannot unwrap buffer of type ".concat(e.constructor.name," to get CPU buffer"))},DeviceCPU}(a.Device);n.DeviceCPU=c},959:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)});Object.defineProperty(n,"__esModule",{value:!0}),n.DeviceWebGPU=void 0;var a=r(955),u=r(912),s=r(861),c=function(e){function DeviceWebGPU(n,r,o){var i=e.call(this,n,"webgpu")||this;return i._device=o,i}return i(DeviceWebGPU,e),Object.defineProperty(DeviceWebGPU.prototype,"gpuDevice",{get:function(){return this._device},enumerable:!1,configurable:!0}),DeviceWebGPU.prototype.alloc=function(e){return new u.GPUBufferStorage(e,this._device,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC)},DeviceWebGPU.prototype.createKernel=function(e,n){return new s.KernelWebGPU(e,n,this)},DeviceWebGPU.prototype.getStorageFromKernel=function(e){if(e instanceof GPUBuffer)return new u.GPUBufferStorage(e,this.gpuDevice);throw new Error("Cannot wrap buffer of type ".concat(e.constructor.name," to get GPU storage"))},DeviceWebGPU.prototype.getBufferForKernel=function(e,n){if(e instanceof u.GPUBufferStorage)return e.gpuBuffer;throw new Error("Cannot unwrap storage of type ".concat(e.constructor.name," to get GPU buffer"))},DeviceWebGPU}(a.Device);n.DeviceWebGPU=c},233:function(e,n,r){var o=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=Promise))((function(i,a){function fulfilled(e){try{step(o.next(e))}catch(e){a(e)}}function rejected(e){try{step(o.throw(e))}catch(e){a(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(n){n(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(s){return function(c){return function step(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(e,u)}catch(e){s=[6,e],o=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.getDevice=n.discoverWebGPUDevicesAsync=void 0;var a=r(514),u=r(959),s=new a.DeviceCPU,c=null,p={cpu:s};n.discoverWebGPUDevicesAsync=function discoverWebGPUDevicesAsync(){return o(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){switch(i.label){case 0:return navigator.gpu?[4,navigator.gpu.requestAdapter()]:[2,!1];case 1:return[4,(e=i.sent()).requestDevice()];case 2:return n=i.sent(),r="webgpu",o=new u.DeviceWebGPU(r,e,n),p[r]=o,c=o,console.log("Found WebGPU device",n),[2,!0]}}))}))},n.getDevice=function getDevice(e){if(null==e)return c||s;if("string"==typeof e){if(e in p)return p[e];var n=function findDeviceWithType(e){for(var n in p)if(p[n].type===e)return p[n];return null}(e);if(n)return n;throw new Error("Device ".concat(e," not found"))}return e}},521:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getDtype=n.dtypeByteSize=n.dtypeArrayCtors=void 0,n.dtypeArrayCtors={uint8:Uint8Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array},n.dtypeByteSize=function dtypeByteSize(e){switch(e){case"uint8":return 1;case"int32":case"uint32":case"float32":return 4;default:throw new Error("Invalid dtype ".concat(e))}},n.getDtype=function getDtype(e,n){if(null==e)return n||"float32";if("uint8"===e)return"uint8";if("int32"===e)return"int32";if("uint32"===e)return"uint32";if("float32"===e)return"float32";if(e instanceof Uint8Array)return"uint8";if(e instanceof Int32Array)return"int32";if(e instanceof Uint32Array)return"uint32";if(e instanceof Float32Array)return"float32";throw new Error("Invalid dtype ".concat(JSON.stringify(e)))}},877:function(e,n){var r=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.evalCode=n.compileCode=n.exprCodeToWebGLShader=n.exprNodeToWebGLShader=n.exprNodeToString=n.substituteIdentifiers=n.substitute=n.parseCode=n.ManifestNumber=void 0;var o=function o(e,n){this.type=e,this.value=n};function parseCode(e){if("number"==typeof e)return new o(e%1==0?"intAbstract":"floatAbstract",e);var n=function lexn(e){for(var n=[],r=e.length,i=0;i<r;){var a=e[i];if(" "!==a&&"\t"!==a&&"\n"!==a)if("+"!==a&&"-"!==a&&"*"!==a&&"/"!==a&&","!=a&&";"!=a&&":"!=a&&"?"!=a&&"^"!=a&&"%"!=a&&"~"!=a&&"("!=a&&")"!=a&&"["!=a&&"]"!=a&&"{"!=a&&"}"!=a&&"."!=a)if("="!=a&&"<"!=a&&">"!=a&&"!"!=a)if("&"!=a)if("|"!=a)if(a>="0"&&a<="9"){for(var u="",s=!1;i<r&&(e[i]>="0"&&e[i]<="9"||"."===e[i]);){if("."===e[i]){if(s)throw new Error("Invalid number");s=!0}u+=e[i],i++}var c=s?"floatAbstract":"intAbstract";n.push(new o(c,parseFloat(u)))}else{if(!(a>="a"&&a<="z"||a>="A"&&a<="Z"||"_"===a))throw new Error("Unexpected character ".concat(a));for(u="";i<r&&(e[i]>="a"&&e[i]<="z"||e[i]>="A"&&e[i]<="Z"||e[i]>="0"&&e[i]<="9"||"_"===e[i]);)u+=e[i],i++;n.push(u)}else{if(i+1<r&&"|"==e[i+1]){n.push("||"),i+=2;continue}n.push("|"),i++}else{if(i+1<r&&"&"==e[i+1]){n.push("&&"),i+=2;continue}n.push("&"),i++}else{if(i+1<r&&"="==e[i+1]){n.push(a+"="),i+=2;continue}n.push(a),i++}else n.push(a),i++;else i++}return n}(e),parsePrimary=function(e){if(e>=n.length)return null;var r=n[e];if(r instanceof o)return[r,e+1];if("("===r){var i=parseExpr(e+1);if(null===i)throw new Error("Missing expression");if((e=i[1])>=n.length)throw new Error("Unexpected end of expression");if("string"!=typeof(c=n[e])||")"!==c)throw new Error("Expected )");return[i[0],e+1]}if(!function tokenIsIdent(e){if(e instanceof o)return!1;if(e.length<=0)return!1;var n=e[0];return(n>="a"&&n<="z"||n>="A"&&n<="Z"||"_"===n)&&"if"!==n&&"else"!==n&&"return"!=n}(r))return null;var a=[r,e+1];if(e+1<n.length&&"("===n[e+1]){for(var u=[],s=e+2;s<n.length;){var c,p=parseExpr(s);if(null===p)throw new Error("Missing argument");if(u.push(p[0]),(s=p[1])>=n.length)throw new Error("Unexpected end of expression");if("string"!=typeof(c=n[s]))throw new Error("Expected , or )");if(")"===c)break;if(","!==c)throw new Error("Expected ,");s++}var l=a[0];u.splice(0,0,l),a=[["apply",u],s+1]}return a};function parseExpr(e){return e>=n.length?null:parseConditional(e)}function parseConditional(r){if(r>=n.length)return null;var o=p(r);if(null===o)return null;if((r=o[1])>=n.length)return o;var i=n[r];if("?"!==i)return o;var a=parseExpr(r+1);if(null===a)throw new Error("Missing expression after ?");if((r=a[1])>=n.length)throw new Error("Unexpected end of conditional expression");var u=n[r];if("string"!=typeof u||":"!==u)throw new Error("Expected :");var s=parseConditional(r+1);if(null===s)throw new Error("Missing expression after : `".concat(e,"`"));return[[i,[o[0],a[0],s[0]]],s[1]]}function genericParseSeparatedList(e,o){var i,a,u={};try{for(var s=r(o),c=s.next();!c.done;c=s.next()){var p=c.value;u[p]=!0}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}return function(r){var o=e(r);if(null===o)return null;for(r=o[1];r<n.length;){var i=n[r];if("string"!=typeof i)break;if(!(i in u))break;var a=e(r+1);if(null===a)throw new Error("Missing expression after "+i);o=[[i,[o[0],a[0]]],a[1]],r=a[1]}return o}}var i=genericParseSeparatedList((function parseUnary(e){if(e>=n.length)return null;var r=n[e];if("string"==typeof r){if("+"===r||"-"===r){var o=parseUnary(e+1);if(null===o)throw new Error("Missing expression");return"+"===r?o:[["negate",[o[0]]],o[1]]}if("!"===r){var i=parseUnary(e+1);if(null===i)throw new Error("Missing expression");return[[r,[i[0]]],i[1]]}}return parsePrimary(e)}),["*","/"]),a=genericParseSeparatedList(i,["+","-"]),u=genericParseSeparatedList(a,["<",">","<=",">="]),s=genericParseSeparatedList(u,["==","!="]),c=genericParseSeparatedList(s,["&&"]),p=genericParseSeparatedList(c,["||"]);function parseStatement(e){if(e>=n.length)return null;if(";"===n[e])return[["block",[]],e+1];if("{"===n[e]){if((i=e+1)>=n.length)throw new Error("Missing } at end of input");if("}"===n[i])return[["block",[]],i+1];var r=parseStatements(i);if(null===r)throw new Error("Missing statements after {");if(i=r[1],"}"!==n[i])throw new Error("Missing } (".concat(n,")"));var o=r[0];return o instanceof Array&&"statements"===o[0]?[["block",o[1]],i+1]:[["block",[o]],i+1]}if("if"===n[e]){var i;if((i=e+1)>=n.length)throw new Error("Missing ( after if");if("("!==n[i])throw new Error("Missing ( after if");var a=parseExpr(i+1);if(null===a)throw new Error("Missing condition after if");if((i=a[1])>=n.length||")"!==n[i])throw new Error("Missing ) after if condition");var u=parseStatement(i+1);if(null===u)throw new Error("Missing then after if condition");if((i=u[1])>=n.length||"else"!==n[i])return[["if",[a[0],u[0]]],i];var s=parseStatement(i+1);if(null===s)throw new Error("Missing else after if condition");return i=s[1],[["if",[a[0],u[0],s[0]]],i]}if("var"===n[e]){var c=n[e+1];if("string"!=typeof c)throw new Error("Missing variable name after var");if("="!==n[e+2])throw new Error("Missing = after var");var p=parseExpr(e+3);if(null===p)throw new Error("Missing initial value after var");return[["var",[c,p[0]]],p[1]]}if("return"===n[e]){var l=parseExpr(e+1);if(null===l)throw new Error("Missing expression after return");return[["return",[l[0]]],l[1]]}var d=parseExpr(e);if(null===d)return null;if((e=d[1])<n.length&&"="===n[e]){var f=parseExpr(e+1);if(null===f)throw new Error("Missing right hand side of assignment");return[["assign",[d[0],f[0]]],f[1]]}return d}function parseStatements(e){if(e>=n.length)return null;var r=parseStatement(e);if(null===r)return null;if((e=r[1])>=n.length)return r;for(var o=[r[0]];e<n.length;){if(";"!==n[e])break;var i=parseStatement(e+=1);if(null===i)break;o.push(i[0]),e=i[1]}return 1===o.length?[o[0],e]:[["statements",o],e]}var l=parseStatements(0);if(null===l)throw new Error("Missing expression");if(l[1]<n.length)throw new Error("Unexpected token '".concat(n[l[1]],"' after parsing ").concat(JSON.stringify(l[0])," from tokens [").concat(n.slice(0,l[1]+1),"]"));return l[0]}function substitute(e,n,i){var a,u;if(e instanceof o)return e;if("string"==typeof e)return e;var s=[];try{for(var c=r(e[1]),p=c.next();!p.done;p=c.next()){var l=p.value;s.push(substitute(l,n,i))}}catch(e){a={error:e}}finally{try{p&&!p.done&&(u=c.return)&&u.call(c)}finally{if(a)throw a.error}}return n(e=[e[0],s])&&(e=i(e)),e}function substituteIdentifiers(e,n){var i,a;if(e instanceof o)return e;if("string"==typeof e)return e in n?n[e]:e;var u=[];try{for(var s=r(e[1]),c=s.next();!c.done;c=s.next()){var p=c.value;u.push(substituteIdentifiers(p,n))}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}return[e[0],u]}function exprNodeToString(e){if(e instanceof o){var n="";return"floatAbstract"===e.type?-1===(n=e.value.toString()).indexOf(".")&&(n+="f"):n=e.value.toString(),n}if("string"==typeof e)return e;switch(e[0]){case"+":return"(".concat(exprNodeToString(e[1][0])," + ").concat(exprNodeToString(e[1][1]),")");case"-":return"(".concat(exprNodeToString(e[1][0])," - ").concat(exprNodeToString(e[1][1]),")");case"*":return"(".concat(exprNodeToString(e[1][0])," * ").concat(exprNodeToString(e[1][1]),")");case"/":return"(".concat(exprNodeToString(e[1][0])," / ").concat(exprNodeToString(e[1][1]),")");case"%":return"(".concat(exprNodeToString(e[1][0])," % ").concat(exprNodeToString(e[1][1]),")");case"==":return"(".concat(exprNodeToString(e[1][0])," == ").concat(exprNodeToString(e[1][1]),")");case"!=":return"(".concat(exprNodeToString(e[1][0])," != ").concat(exprNodeToString(e[1][1]),")");case"<":return"(".concat(exprNodeToString(e[1][0])," < ").concat(exprNodeToString(e[1][1]),")");case">":return"(".concat(exprNodeToString(e[1][0])," > ").concat(exprNodeToString(e[1][1]),")");case"<=":return"(".concat(exprNodeToString(e[1][0])," <= ").concat(exprNodeToString(e[1][1]),")");case">=":return"(".concat(exprNodeToString(e[1][0])," >= ").concat(exprNodeToString(e[1][1]),")");case"&&":return"(".concat(exprNodeToString(e[1][0])," && ").concat(exprNodeToString(e[1][1]),")");case"||":return"(".concat(exprNodeToString(e[1][0])," || ").concat(exprNodeToString(e[1][1]),")");case"?":return"(".concat(exprNodeToString(e[1][0])," ? ").concat(exprNodeToString(e[1][1])," : ").concat(exprNodeToString(e[1][2]),")");case"apply":var r=exprNodeToString(e[1][0]),i=e[1].slice(1).map(exprNodeToString);return"".concat(r,"(").concat(i.join(", "),")");case"block":return"{ ".concat(e[1].map(exprNodeToString).join("; ")," }");case"assign":var a=e[1][0],u=e[1][1];return"".concat(exprNodeToString(a)," = ").concat(exprNodeToString(u));case"if":var s=e[1][0],c=e[1][1],p=e[1][2];return"if (".concat(exprNodeToString(s),") { ").concat(exprNodeToString(c)," } else { ").concat(exprNodeToString(p)," }");case"negate":return"(-".concat(exprNodeToString(e[1][0]),")");case"statements":return e[1].map(exprNodeToString).join("; ");case"return":return"return ".concat(exprNodeToString(e[1][0]));case"var":return"var ".concat(e[1][0]," = ").concat(exprNodeToString(e[1][1]));default:throw new Error("Unknown AST node type when printing: ".concat(e[0]))}}function exprNodeToWebGLShader(e){return exprNodeToString(e=substitute(e,(function(e){return e instanceof Array&&"?"===e[0]}),(function(e){var n=e[1][0],r=e[1][1];return["apply",["select",e[1][2],r,n]]})))}n.ManifestNumber=o,n.parseCode=parseCode,n.substitute=substitute,n.substituteIdentifiers=substituteIdentifiers,n.exprNodeToString=exprNodeToString,n.exprNodeToWebGLShader=exprNodeToWebGLShader,n.exprCodeToWebGLShader=function exprCodeToWebGLShader(e,n){var r=parseCode(e);return n&&(r=substituteIdentifiers(r,n)),exprNodeToWebGLShader(r)};var i=0,a=1,u=2,s=3,c=4,p=5;function compileCode(e){if("number"==typeof e)return function(){return e};var n=parseCode(e),l=[];return function emit(e){if(e instanceof o)l.push([i,e.value]);else{if("string"!=typeof e){if("+"===e[0])return emit(e[1][0]),emit(e[1][1]),void l.push([u,null]);if("-"===e[0])return emit(e[1][0]),emit(e[1][1]),void l.push([s,null]);if("*"===e[0])return emit(e[1][0]),emit(e[1][1]),void l.push([c,null]);if("/"===e[0])return emit(e[1][0]),emit(e[1][1]),void l.push([p,null]);throw new Error("Unknown node type ".concat(e))}l.push([a,e])}}(n),function(e){var n,o,i=[];try{for(var a=r(l),u=a.next();!u.done;u=a.next()){var s=u.value,c=s[0];if(0===c)i.push(s[1]);else if(1==c)i.push(e[s[1]]);else{var p=i.pop(),d=i.pop();switch(c){case 2:i.push(d+p);break;case 3:i.push(d-p);break;case 4:i.push(d*p);break;case 5:i.push(d/p)}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return i[0]}}n.compileCode=compileCode,n.evalCode=function evalCode(e,n){return"number"==typeof e?e:compileCode(e)(n)}},357:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.zeros=n.ones=void 0;var o=r(610),i=r(233),a=r(521),u=r(784);n.ones=function ones(e,n,r){var s=(0,i.getDevice)(r),c=(0,o.getShape)(e),p=(0,a.getDtype)(n),l=s.allocFor(c,p);return l.getTypedArray(p).fill(1),new u.Tensor({data:l,dtype:p,shape:c,strides:(0,o.defaultStrides)(c),device:s})},n.zeros=function zeros(e,n,r){var s=(0,i.getDevice)(r),c=(0,o.getShape)(e),p=(0,a.getDtype)(n),l=s.allocFor(c,p);return l.getTypedArray(p).fill(1),new u.Tensor({data:l,dtype:p,shape:c,strides:(0,o.defaultStrides)(c),device:s})}},146:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u};Object.defineProperty(n,"__esModule",{value:!0}),n.AllFunction=n.XlogyFunction=n.TruncFunction=n.TanhFunction=n.TanFunction=n.SubFunction=n.SquareFunction=n.SqrtFunction=n.SinhFunction=n.SincFunction=n.SinFunction=n.SiluFunction=n.SignFunction=n.SigmoidFunction=n.RsqrtFunction=n.RoundFunction=n.ReluFunction=n.ReciprocalFunction=n.Rad2degFunction=n.PowFunction=n.PositiveFunction=n.NegFunction=n.MulFunction=n.Logaddexp2Function=n.LogaddexpFunction=n.Log2Function=n.Log1pFunction=n.Log10Function=n.LogFunction=n.LdexpFunction=n.HypotFunction=n.FracFunction=n.FloorFunction=n.Expm1Function=n.Exp2Function=n.ExpFunction=n.DivFunction=n.Deg2radFunction=n.CoshFunction=n.CosFunction=n.CopysignFunction=n.CeilFunction=n.Atan2Function=n.AtanFunction=n.AsinhFunction=n.AsinFunction=n.AddFunction=n.AcoshFunction=n.AcosFunction=n.AbsFunction=void 0,n.CountNonzeroFunction=n.SumFunction=n.ProdFunction=n.NormFunction=n.MeanFunction=n.AnyFunction=void 0;var u=r(510),s=r(610),c=function(e){function AbsFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AbsFunction,e),AbsFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("abs",{dtype:"float32"},r,[n.shape])[0]},AbsFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AbsFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("absGrad",{dtype:"float32"},o,[r.shape],n)},AbsFunction}(u.AutoFunction);n.AbsFunction=c;var p=function(e){function AcosFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AcosFunction,e),AcosFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("acos",{dtype:"float32"},r,[n.shape])[0]},AcosFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AcosFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("acosGrad",{dtype:"float32"},o,[r.shape],n)},AcosFunction}(u.AutoFunction);n.AcosFunction=p;var l=function(e){function AcoshFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AcoshFunction,e),AcoshFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("acosh",{dtype:"float32"},r,[n.shape])[0]},AcoshFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AcoshFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("acoshGrad",{dtype:"float32"},o,[r.shape],n)},AcoshFunction}(u.AutoFunction);n.AcoshFunction=l;var d=function(e){function AddFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AddFunction,e),AddFunction.forward=function(e){var n=a(e,3),r=n[0],o=n[1],i=n[2],u={size:(0,s.shapeSize)(r.shape),alpha:i||1};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("add",{dtype:"float32"},u,[r.shape],o)[0]},AddFunction.setupContext=function(e,n,r){var o=a(n,3),i=o[0],u=o[1],s=o[2];e.alpha=s,e.saveForBackward(i,u)},AddFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape),alpha:e.alpha||1};return o.runKernel("addGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},AddFunction}(u.AutoFunction);n.AddFunction=d;var f=function(e){function AsinFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AsinFunction,e),AsinFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("asin",{dtype:"float32"},r,[n.shape])[0]},AsinFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AsinFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("asinGrad",{dtype:"float32"},o,[r.shape],n)},AsinFunction}(u.AutoFunction);n.AsinFunction=f;var h=function(e){function AsinhFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AsinhFunction,e),AsinhFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("asinh",{dtype:"float32"},r,[n.shape])[0]},AsinhFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AsinhFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("asinhGrad",{dtype:"float32"},o,[r.shape],n)},AsinhFunction}(u.AutoFunction);n.AsinhFunction=h;var y=function(e){function AtanFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AtanFunction,e),AtanFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("atan",{dtype:"float32"},r,[n.shape])[0]},AtanFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AtanFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("atanGrad",{dtype:"float32"},o,[r.shape],n)},AtanFunction}(u.AutoFunction);n.AtanFunction=y;var v=function(e){function Atan2Function(){return null!==e&&e.apply(this,arguments)||this}return i(Atan2Function,e),Atan2Function.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("atan2",{dtype:"float32"},i,[r.shape],o)[0]},Atan2Function.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},Atan2Function.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("atan2Grad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},Atan2Function}(u.AutoFunction);n.Atan2Function=v;var g=function(e){function CeilFunction(){return null!==e&&e.apply(this,arguments)||this}return i(CeilFunction,e),CeilFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("ceil",{dtype:"float32"},r,[n.shape])[0]},CeilFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},CeilFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("ceilGrad",{dtype:"float32"},o,[r.shape],n)},CeilFunction}(u.AutoFunction);n.CeilFunction=g;var w=function(e){function CopysignFunction(){return null!==e&&e.apply(this,arguments)||this}return i(CopysignFunction,e),CopysignFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("copysign",{dtype:"float32"},i,[r.shape],o)[0]},CopysignFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},CopysignFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("copysignGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},CopysignFunction}(u.AutoFunction);n.CopysignFunction=w;var b=function(e){function CosFunction(){return null!==e&&e.apply(this,arguments)||this}return i(CosFunction,e),CosFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("cos",{dtype:"float32"},r,[n.shape])[0]},CosFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},CosFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("cosGrad",{dtype:"float32"},o,[r.shape],n)},CosFunction}(u.AutoFunction);n.CosFunction=b;var m=function(e){function CoshFunction(){return null!==e&&e.apply(this,arguments)||this}return i(CoshFunction,e),CoshFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("cosh",{dtype:"float32"},r,[n.shape])[0]},CoshFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},CoshFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("coshGrad",{dtype:"float32"},o,[r.shape],n)},CoshFunction}(u.AutoFunction);n.CoshFunction=m;var _=function(e){function Deg2radFunction(){return null!==e&&e.apply(this,arguments)||this}return i(Deg2radFunction,e),Deg2radFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("deg2rad",{dtype:"float32"},r,[n.shape])[0]},Deg2radFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Deg2radFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("deg2radGrad",{dtype:"float32"},o,[r.shape],n)},Deg2radFunction}(u.AutoFunction);n.Deg2radFunction=_;var S=function(e){function DivFunction(){return null!==e&&e.apply(this,arguments)||this}return i(DivFunction,e),DivFunction.forward=function(e){var n=a(e,3),r=n[0],o=n[1],i=n[2],u={size:(0,s.shapeSize)(r.shape),alpha:i||1};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("div",{dtype:"float32"},u,[r.shape],o)[0]},DivFunction.setupContext=function(e,n,r){var o=a(n,3),i=o[0],u=o[1],s=o[2];e.alpha=s,e.saveForBackward(i,u)},DivFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape),alpha:e.alpha||1};return o.runKernel("divGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},DivFunction}(u.AutoFunction);n.DivFunction=S;var F=function(e){function ExpFunction(){return null!==e&&e.apply(this,arguments)||this}return i(ExpFunction,e),ExpFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("exp",{dtype:"float32"},r,[n.shape])[0]},ExpFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},ExpFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("expGrad",{dtype:"float32"},o,[r.shape],n)},ExpFunction}(u.AutoFunction);n.ExpFunction=F;var x=function(e){function Exp2Function(){return null!==e&&e.apply(this,arguments)||this}return i(Exp2Function,e),Exp2Function.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("exp2",{dtype:"float32"},r,[n.shape])[0]},Exp2Function.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Exp2Function.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("exp2Grad",{dtype:"float32"},o,[r.shape],n)},Exp2Function}(u.AutoFunction);n.Exp2Function=x;var z=function(e){function Expm1Function(){return null!==e&&e.apply(this,arguments)||this}return i(Expm1Function,e),Expm1Function.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("expm1",{dtype:"float32"},r,[n.shape])[0]},Expm1Function.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Expm1Function.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("expm1Grad",{dtype:"float32"},o,[r.shape],n)},Expm1Function}(u.AutoFunction);n.Expm1Function=z;var T=function(e){function FloorFunction(){return null!==e&&e.apply(this,arguments)||this}return i(FloorFunction,e),FloorFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("floor",{dtype:"float32"},r,[n.shape])[0]},FloorFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},FloorFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("floorGrad",{dtype:"float32"},o,[r.shape],n)},FloorFunction}(u.AutoFunction);n.FloorFunction=T;var C=function(e){function FracFunction(){return null!==e&&e.apply(this,arguments)||this}return i(FracFunction,e),FracFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("frac",{dtype:"float32"},r,[n.shape])[0]},FracFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},FracFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("fracGrad",{dtype:"float32"},o,[r.shape],n)},FracFunction}(u.AutoFunction);n.FracFunction=C;var k=function(e){function HypotFunction(){return null!==e&&e.apply(this,arguments)||this}return i(HypotFunction,e),HypotFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("hypot",{dtype:"float32"},i,[r.shape],o)[0]},HypotFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},HypotFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("hypotGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},HypotFunction}(u.AutoFunction);n.HypotFunction=k;var G=function(e){function LdexpFunction(){return null!==e&&e.apply(this,arguments)||this}return i(LdexpFunction,e),LdexpFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("ldexp",{dtype:"float32"},i,[r.shape],o)[0]},LdexpFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},LdexpFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("ldexpGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},LdexpFunction}(u.AutoFunction);n.LdexpFunction=G;var A=function(e){function LogFunction(){return null!==e&&e.apply(this,arguments)||this}return i(LogFunction,e),LogFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("log",{dtype:"float32"},r,[n.shape])[0]},LogFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},LogFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("logGrad",{dtype:"float32"},o,[r.shape],n)},LogFunction}(u.AutoFunction);n.LogFunction=A;var P=function(e){function Log10Function(){return null!==e&&e.apply(this,arguments)||this}return i(Log10Function,e),Log10Function.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("log10",{dtype:"float32"},r,[n.shape])[0]},Log10Function.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Log10Function.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("log10Grad",{dtype:"float32"},o,[r.shape],n)},Log10Function}(u.AutoFunction);n.Log10Function=P;var E=function(e){function Log1pFunction(){return null!==e&&e.apply(this,arguments)||this}return i(Log1pFunction,e),Log1pFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("log1p",{dtype:"float32"},r,[n.shape])[0]},Log1pFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Log1pFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("log1pGrad",{dtype:"float32"},o,[r.shape],n)},Log1pFunction}(u.AutoFunction);n.Log1pFunction=E;var K=function(e){function Log2Function(){return null!==e&&e.apply(this,arguments)||this}return i(Log2Function,e),Log2Function.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("log2",{dtype:"float32"},r,[n.shape])[0]},Log2Function.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Log2Function.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("log2Grad",{dtype:"float32"},o,[r.shape],n)},Log2Function}(u.AutoFunction);n.Log2Function=K;var B=function(e){function LogaddexpFunction(){return null!==e&&e.apply(this,arguments)||this}return i(LogaddexpFunction,e),LogaddexpFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("logaddexp",{dtype:"float32"},i,[r.shape],o)[0]},LogaddexpFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},LogaddexpFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("logaddexpGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},LogaddexpFunction}(u.AutoFunction);n.LogaddexpFunction=B;var O=function(e){function Logaddexp2Function(){return null!==e&&e.apply(this,arguments)||this}return i(Logaddexp2Function,e),Logaddexp2Function.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("logaddexp2",{dtype:"float32"},i,[r.shape],o)[0]},Logaddexp2Function.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},Logaddexp2Function.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("logaddexp2Grad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},Logaddexp2Function}(u.AutoFunction);n.Logaddexp2Function=O;var M=function(e){function MulFunction(){return null!==e&&e.apply(this,arguments)||this}return i(MulFunction,e),MulFunction.forward=function(e){var n=a(e,3),r=n[0],o=n[1],i=n[2],u={size:(0,s.shapeSize)(r.shape),alpha:i||1};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("mul",{dtype:"float32"},u,[r.shape],o)[0]},MulFunction.setupContext=function(e,n,r){var o=a(n,3),i=o[0],u=o[1],s=o[2];e.alpha=s,e.saveForBackward(i,u)},MulFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape),alpha:e.alpha||1};return o.runKernel("mulGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},MulFunction}(u.AutoFunction);n.MulFunction=M;var U=function(e){function NegFunction(){return null!==e&&e.apply(this,arguments)||this}return i(NegFunction,e),NegFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("neg",{dtype:"float32"},r,[n.shape])[0]},NegFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},NegFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("negGrad",{dtype:"float32"},o,[r.shape],n)},NegFunction}(u.AutoFunction);n.NegFunction=U;var L=function(e){function PositiveFunction(){return null!==e&&e.apply(this,arguments)||this}return i(PositiveFunction,e),PositiveFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("positive",{dtype:"float32"},r,[n.shape])[0]},PositiveFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},PositiveFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("positiveGrad",{dtype:"float32"},o,[r.shape],n)},PositiveFunction}(u.AutoFunction);n.PositiveFunction=L;var I=function(e){function PowFunction(){return null!==e&&e.apply(this,arguments)||this}return i(PowFunction,e),PowFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("pow",{dtype:"float32"},i,[r.shape],o)[0]},PowFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},PowFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("powGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},PowFunction}(u.AutoFunction);n.PowFunction=I;var j=function(e){function Rad2degFunction(){return null!==e&&e.apply(this,arguments)||this}return i(Rad2degFunction,e),Rad2degFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("rad2deg",{dtype:"float32"},r,[n.shape])[0]},Rad2degFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},Rad2degFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("rad2degGrad",{dtype:"float32"},o,[r.shape],n)},Rad2degFunction}(u.AutoFunction);n.Rad2degFunction=j;var D=function(e){function ReciprocalFunction(){return null!==e&&e.apply(this,arguments)||this}return i(ReciprocalFunction,e),ReciprocalFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("reciprocal",{dtype:"float32"},r,[n.shape])[0]},ReciprocalFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},ReciprocalFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("reciprocalGrad",{dtype:"float32"},o,[r.shape],n)},ReciprocalFunction}(u.AutoFunction);n.ReciprocalFunction=D;var N=function(e){function ReluFunction(){return null!==e&&e.apply(this,arguments)||this}return i(ReluFunction,e),ReluFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("relu",{dtype:"float32"},r,[n.shape])[0]},ReluFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},ReluFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("reluGrad",{dtype:"float32"},o,[r.shape],n)},ReluFunction}(u.AutoFunction);n.ReluFunction=N;var q=function(e){function RoundFunction(){return null!==e&&e.apply(this,arguments)||this}return i(RoundFunction,e),RoundFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("round",{dtype:"float32"},r,[n.shape])[0]},RoundFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},RoundFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("roundGrad",{dtype:"float32"},o,[r.shape],n)},RoundFunction}(u.AutoFunction);n.RoundFunction=q;var W=function(e){function RsqrtFunction(){return null!==e&&e.apply(this,arguments)||this}return i(RsqrtFunction,e),RsqrtFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("rsqrt",{dtype:"float32"},r,[n.shape])[0]},RsqrtFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},RsqrtFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("rsqrtGrad",{dtype:"float32"},o,[r.shape],n)},RsqrtFunction}(u.AutoFunction);n.RsqrtFunction=W;var R=function(e){function SigmoidFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SigmoidFunction,e),SigmoidFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sigmoid",{dtype:"float32"},r,[n.shape])[0]},SigmoidFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SigmoidFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sigmoidGrad",{dtype:"float32"},o,[r.shape],n)},SigmoidFunction}(u.AutoFunction);n.SigmoidFunction=R;var H=function(e){function SignFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SignFunction,e),SignFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sign",{dtype:"float32"},r,[n.shape])[0]},SignFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SignFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("signGrad",{dtype:"float32"},o,[r.shape],n)},SignFunction}(u.AutoFunction);n.SignFunction=H;var X=function(e){function SiluFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SiluFunction,e),SiluFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("silu",{dtype:"float32"},r,[n.shape])[0]},SiluFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SiluFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("siluGrad",{dtype:"float32"},o,[r.shape],n)},SiluFunction}(u.AutoFunction);n.SiluFunction=X;var Y=function(e){function SinFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SinFunction,e),SinFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sin",{dtype:"float32"},r,[n.shape])[0]},SinFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SinFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sinGrad",{dtype:"float32"},o,[r.shape],n)},SinFunction}(u.AutoFunction);n.SinFunction=Y;var Z=function(e){function SincFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SincFunction,e),SincFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sinc",{dtype:"float32"},r,[n.shape])[0]},SincFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SincFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sincGrad",{dtype:"float32"},o,[r.shape],n)},SincFunction}(u.AutoFunction);n.SincFunction=Z;var $=function(e){function SinhFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SinhFunction,e),SinhFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sinh",{dtype:"float32"},r,[n.shape])[0]},SinhFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SinhFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sinhGrad",{dtype:"float32"},o,[r.shape],n)},SinhFunction}(u.AutoFunction);n.SinhFunction=$;var V=function(e){function SqrtFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SqrtFunction,e),SqrtFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sqrt",{dtype:"float32"},r,[n.shape])[0]},SqrtFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SqrtFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sqrtGrad",{dtype:"float32"},o,[r.shape],n)},SqrtFunction}(u.AutoFunction);n.SqrtFunction=V;var J=function(e){function SquareFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SquareFunction,e),SquareFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("square",{dtype:"float32"},r,[n.shape])[0]},SquareFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SquareFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("squareGrad",{dtype:"float32"},o,[r.shape],n)},SquareFunction}(u.AutoFunction);n.SquareFunction=J;var Q=function(e){function SubFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SubFunction,e),SubFunction.forward=function(e){var n=a(e,3),r=n[0],o=n[1],i=n[2],u={size:(0,s.shapeSize)(r.shape),alpha:i||1};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("sub",{dtype:"float32"},u,[r.shape],o)[0]},SubFunction.setupContext=function(e,n,r){var o=a(n,3),i=o[0],u=o[1],s=o[2];e.alpha=s,e.saveForBackward(i,u)},SubFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape),alpha:e.alpha||1};return o.runKernel("subGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},SubFunction}(u.AutoFunction);n.SubFunction=Q;var ee=function(e){function TanFunction(){return null!==e&&e.apply(this,arguments)||this}return i(TanFunction,e),TanFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("tan",{dtype:"float32"},r,[n.shape])[0]},TanFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},TanFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("tanGrad",{dtype:"float32"},o,[r.shape],n)},TanFunction}(u.AutoFunction);n.TanFunction=ee;var te=function(e){function TanhFunction(){return null!==e&&e.apply(this,arguments)||this}return i(TanhFunction,e),TanhFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("tanh",{dtype:"float32"},r,[n.shape])[0]},TanhFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},TanhFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("tanhGrad",{dtype:"float32"},o,[r.shape],n)},TanhFunction}(u.AutoFunction);n.TanhFunction=te;var ne=function(e){function TruncFunction(){return null!==e&&e.apply(this,arguments)||this}return i(TruncFunction,e),TruncFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("trunc",{dtype:"float32"},r,[n.shape])[0]},TruncFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},TruncFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("truncGrad",{dtype:"float32"},o,[r.shape],n)},TruncFunction}(u.AutoFunction);n.TruncFunction=ne;var re=function(e){function XlogyFunction(){return null!==e&&e.apply(this,arguments)||this}return i(XlogyFunction,e),XlogyFunction.forward=function(e){var n=a(e,2),r=n[0],o=n[1],i={size:(0,s.shapeSize)(r.shape)};if(!r.isContiguous)throw new Error("Input must be contiguous");if(!o.isContiguous)throw new Error("Other must be contiguous");return r.runKernel("xlogy",{dtype:"float32"},i,[r.shape],o)[0]},XlogyFunction.setupContext=function(e,n,r){var o=a(n,2),i=o[0],u=o[1];e.saveForBackward(i,u)},XlogyFunction.backward=function(e,n){var r=a(e.savedTensors,2),o=r[0],i=r[1],u={size:(0,s.shapeSize)(o.shape)};return o.runKernel("xlogyGrad",{dtype:"float32"},u,[o.shape,i.shape],i,n)},XlogyFunction}(u.AutoFunction);n.XlogyFunction=re;var oe=function(e){function AllFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AllFunction,e),AllFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("all",{dtype:"float32",workgroupSize:64},r,[[]])[0]},AllFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AllFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("allGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},AllFunction}(u.AutoFunction);n.AllFunction=oe;var ie=function(e){function AnyFunction(){return null!==e&&e.apply(this,arguments)||this}return i(AnyFunction,e),AnyFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("any",{dtype:"float32",workgroupSize:64},r,[[]])[0]},AnyFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},AnyFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("anyGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},AnyFunction}(u.AutoFunction);n.AnyFunction=ie;var ae=function(e){function MeanFunction(){return null!==e&&e.apply(this,arguments)||this}return i(MeanFunction,e),MeanFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("mean",{dtype:"float32",workgroupSize:64},r,[[]])[0]},MeanFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},MeanFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("meanGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},MeanFunction}(u.AutoFunction);n.MeanFunction=ae;var ue=function(e){function NormFunction(){return null!==e&&e.apply(this,arguments)||this}return i(NormFunction,e),NormFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("norm",{dtype:"float32",workgroupSize:64},r,[[]])[0]},NormFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},NormFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("normGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},NormFunction}(u.AutoFunction);n.NormFunction=ue;var se=function(e){function ProdFunction(){return null!==e&&e.apply(this,arguments)||this}return i(ProdFunction,e),ProdFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("prod",{dtype:"float32",workgroupSize:64},r,[[]])[0]},ProdFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},ProdFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("prodGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},ProdFunction}(u.AutoFunction);n.ProdFunction=se;var ce=function(e){function SumFunction(){return null!==e&&e.apply(this,arguments)||this}return i(SumFunction,e),SumFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("sum",{dtype:"float32",workgroupSize:64},r,[[]])[0]},SumFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},SumFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("sumGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},SumFunction}(u.AutoFunction);n.SumFunction=ce;var pe=function(e){function CountNonzeroFunction(){return null!==e&&e.apply(this,arguments)||this}return i(CountNonzeroFunction,e),CountNonzeroFunction.forward=function(e){var n=a(e,1)[0],r={size:(0,s.shapeSize)(n.shape)};if(!n.isContiguous)throw new Error("Input must be contiguous");return n.runKernel("countNonzero",{dtype:"float32",workgroupSize:64},r,[[]])[0]},CountNonzeroFunction.setupContext=function(e,n,r){var o=a(n,1)[0];e.saveForBackward(o)},CountNonzeroFunction.backward=function(e,n){var r=a(e.savedTensors,1)[0],o={size:(0,s.shapeSize)(r.shape)};return r.runKernel("countNonzeroGrad",{dtype:"float32",workgroupSize:64},o,[r.shape],n)},CountNonzeroFunction}(u.AutoFunction);n.CountNonzeroFunction=pe},607:function(e,n,r){var o=this&&this.__createBinding||(Object.create?function(e,n,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(n,r);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[r]}}),Object.defineProperty(e,o,i)}:function(e,n,r,o){void 0===o&&(o=r),e[o]=n[r]}),i=this&&this.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||o(n,e,r)};Object.defineProperty(n,"__esModule",{value:!0}),n.initWebGPUAsync=n.hasWebGPU=n.UntypedStorage=n.nn=n.Kernel=n.Device=n.GradientContext=void 0;var a=r(510);Object.defineProperty(n,"GradientContext",{enumerable:!0,get:function(){return a.GradientContext}});var u=r(955);Object.defineProperty(n,"Device",{enumerable:!0,get:function(){return u.Device}}),i(r(357),n);var s=r(621);Object.defineProperty(n,"Kernel",{enumerable:!0,get:function(){return s.Kernel}}),i(r(716),n),n.nn=r(32),i(r(610),n);var c=r(912);Object.defineProperty(n,"UntypedStorage",{enumerable:!0,get:function(){return c.UntypedStorage}}),i(r(784),n);var p=r(889);Object.defineProperty(n,"hasWebGPU",{enumerable:!0,get:function(){return p.hasWebGPU}}),Object.defineProperty(n,"initWebGPUAsync",{enumerable:!0,get:function(){return p.initWebGPUAsync}})},621:function(e,n,r){var o,i,a=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u};Object.defineProperty(n,"__esModule",{value:!0}),n.getKernelJavaScriptCode=n.getKernelShaderCode=n.shaderTypeToDtype=n.getShaderTypeElementByteSize=n.getKernelKey=n.getKernelConfig=n.Kernel=void 0;var s=r(877),c=r(351),p=function(){function Kernel(e,n,r){this._key=getKernelKey(e,n),this._device=r,this._spec=e,this._config=n,this._workgroupCountXFunc=(0,s.compileCode)(e.workgroupCount[0]),this._workgroupCountYFunc=(0,s.compileCode)(e.workgroupCount[1]),this._workgroupCountZFunc=(0,s.compileCode)(e.workgroupCount[2]),this._outputSizeFuncs=[];for(var o=0;o<this._spec.outputs.length;o++){var i=this._spec.outputs[o],a=(0,s.compileCode)(i.size);this._outputSizeFuncs.push(a)}}return Object.defineProperty(Kernel.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(Kernel.prototype,"spec",{get:function(){return this._spec},enumerable:!1,configurable:!0}),Object.defineProperty(Kernel.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(Kernel.prototype,"device",{get:function(){return this._device},enumerable:!1,configurable:!0}),Kernel.prototype.getRunEnv=function(e){for(var n={},r=0;r<this._spec.config.length;r++){var o=this._spec.config[r],i=this._config[r];n[o.name]=i}for(r=0;r<this.spec.parameters.length;r++){var a=this.spec.parameters[r],u=e[a.name];if(void 0===u)throw new Error("Missing parameter ".concat(a.name));n[a.name]=u}return n},Kernel.prototype.getWorkgroupCounts=function(e){return[Math.ceil(this._workgroupCountXFunc(e)),Math.ceil(this._workgroupCountYFunc(e)),Math.ceil(this._workgroupCountZFunc(e))]},Kernel}();function getKernelKey(e,n){for(var r=[e.name],o=0;o<e.config.length;o++){var i=e.config[o],a=n[o];r.push("".concat(i.name,"=").concat(a))}return r.join(",")}function configShader(e,n){for(var r,o,i=[],s={},c=0;c<e.config.length;c++){var p=e.config[c],l=n[c];i.push([p.name,l.toString()]),s[p.name]=l}var d=e.shader.trim();try{for(var f=a(i),h=f.next();!h.done;h=f.next()){var y=u(h.value,2),v=y[0],g=y[1];d=d.replace(new RegExp("\\$\\$".concat(v,"\\$\\$"),"g"),g)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return[d,s]}n.Kernel=p,n.getKernelConfig=function getKernelConfig(e,n){for(var r=[],o=0;o<e.config.length;o++){var i=e.config[o],a=n[i.name];if(void 0===a)throw new Error('Missing config value "'.concat(i.name,'" for kernel "').concat(e.name,'"'));r.push(a)}return r},n.getKernelKey=getKernelKey,n.getShaderTypeElementByteSize=function getShaderTypeElementByteSize(e){switch(e){case"f32":case"i32":case"u32":case"array<f32>":case"array<i32>":case"array<u32>":return 4;case"u8":case"array<u8>":return 1;default:throw new Error("Unknown shader type ".concat(e))}},n.shaderTypeToDtype=function shaderTypeToDtype(e){switch(e){case"f32":case"array<f32>":return"float32";case"i32":case"array<i32>":return"int32";case"u32":case"array<u32>":return"uint32";case"u8":case"array<u8>":return"uint8";default:throw new Error("Unknown shader type ".concat(e))}},n.getKernelShaderCode=function getKernelShaderCode(e,n){var r=u(configShader(e,n),2),o=r[0],i=r[1],a=["// "+e.name+" kernel"];a.push("struct ".concat(e.name,"Parameters {"));for(var c=0;c<e.parameters.length;c++){var p=e.parameters[c];a.push("    ".concat(p.name,": ").concat(p.shaderType,","))}a.push("}");var l=0;for(c=0;c<e.inputs.length;c++,l++){var d=e.inputs[c];a.push("@group(0) @binding(".concat(l,") var<storage, read> ").concat(d.name,": ").concat(d.shaderType,";"))}for(c=0;c<e.outputs.length;c++,l++){var f=e.outputs[c];a.push("@group(0) @binding(".concat(l,") var<storage, read_write> ").concat(f.name,": ").concat(f.shaderType,";"))}a.push("@group(0) @binding(".concat(l,") var<storage, read> parameters: ").concat(e.name,"Parameters;"));var h=Math.ceil((0,s.evalCode)(e.workgroupSize[0],i)),y=Math.ceil((0,s.evalCode)(e.workgroupSize[1],i)),v=Math.ceil((0,s.evalCode)(e.workgroupSize[2],i));a.push("@compute @workgroup_size(".concat(h,", ").concat(y,", ").concat(v,")")),a.push("fn main(");var g="";return o.includes("global_id")&&(a.push("    ".concat(g,"@builtin(global_invocation_id) global_id: vec3u")),g=", "),o.includes("local_id")&&(a.push("    ".concat(g,"@builtin(local_invocation_id) local_id: vec3u")),g=", "),a.push("    ) {"),a.push("    "+o),a.push("}"),a.join("\n")};var l=[["(\\d+)u","$1"],["(\\d+)f","$1"],["(\\d+\\.\\d+)f","$1"],["global_id\\.x","global_id_x"],["global_id\\.y","global_id_y"],["global_id\\.z","global_id_z"],["local_id\\.x","local_id_x"],["local_id\\.y","local_id_y"],["local_id\\.z","local_id_z"],["workgroupBarrier\\s*\\(\\s*\\)\\s*;",'yield "workgroupBarrier";'],["storageBarrier\\s*\\(\\s*\\)\\s*;",'yield "storageBarrier";']].map((function(e){var n=u(e,2),r=n[0],o=n[1];return[new RegExp(r,"g"),o]}));try{for(var d=a(Object.getOwnPropertyNames(Math)),f=d.next();!f.done;f=d.next()){var h=f.value;"function"==typeof Math[h]&&l.push([new RegExp("\\b".concat(h,"\\("),"g"),"Math.".concat(h,"(")])}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}var y={exp2:"function exp2(x) { return Math.pow(2, x); }",fract:"function fract(x) { return x - Math.floor(x); }",select:"function select(falseValue, trueValue, condition) { return condition ? trueValue : falseValue; }"};n.getKernelJavaScriptCode=function getKernelJavaScriptCode(e,n){var r,o,i,p,d,f,h=u(configShader(e,n),2),v=h[0],g=h[1],w=v.includes("global_id"),b=v.includes("local_id"),m=v.includes("workgroupBarrier")||v.includes("storageBarrier"),_=v;try{for(var S=a(l),F=S.next();!F.done;F=S.next()){var x=u(F.value,2),z=x[0],T=x[1];_=_.replace(z,T)}}catch(e){r={error:e}}finally{try{F&&!F.done&&(o=S.return)&&o.call(S)}finally{if(r)throw r.error}}var C=function getIdentifiers(e){for(var n,r=/[a-zA-Z_][a-zA-Z0-9_]*/g,o=new Set;null!==(n=r.exec(e));)o.add(n[0]);return Array.from(o)}(_),k=new Set;try{for(var G=a(C),A=G.next();!A.done;A=G.next()){var P=A.value;P in y&&k.add(P)}}catch(e){i={error:e}}finally{try{A&&!A.done&&(p=G.return)&&p.call(G)}finally{if(i)throw i.error}}for(var E=Array.from(k),K=new c.CodeWriter,B=[],O=0,M=0;M<e.inputs.length;M++,O++){var U=e.inputs[M];B.push(U.name)}for(M=0;M<e.outputs.length;M++,O++){var L=e.outputs[M];B.push(L.name)}B.push("parameters"),B.push("workgroupCountX"),B.push("workgroupCountY"),B.push("workgroupCountZ");var I=Math.ceil((0,s.evalCode)(e.workgroupSize[0],g)),j=Math.ceil((0,s.evalCode)(e.workgroupSize[1],g)),D=Math.ceil((0,s.evalCode)(e.workgroupSize[2],g));K.writeLine("((".concat(B.join(", "),") => {")),K.indent();try{for(var N=a(E),q=N.next();!q.done;q=N.next()){var W=q.value;K.writeLine(y[W])}}catch(e){d={error:e}}finally{try{q&&!q.done&&(f=N.return)&&f.call(N)}finally{if(d)throw d.error}}var R=[];w&&(R.push("global_id_x"),R.push("global_id_y"),R.push("global_id_z")),b&&(R.push("local_id_x"),R.push("local_id_y"),R.push("local_id_z"));var H=R.join(", ");K.writeLine("function".concat(m?"*":""," ").concat(e.name,"Kernel(").concat(H,") {")),K.indent(),K.writeLine(_),K.dedent(),K.writeLine("}");var X=I*j*D;return m&&K.writeLine("var barriers = new Array(".concat(X,");")),K.writeLine("for (let wgZ = 0; wgZ < workgroupCountZ; wgZ++) {"),K.indent(),K.writeLine("for (let wgY = 0; wgY < workgroupCountY; wgY++) {"),K.indent(),K.writeLine("for (let group_id_x = 0; group_id_x < workgroupCountX; group_id_x++) {"),K.indent(),K.writeLine("const globalStartX = group_id_x * ".concat(I,";")),K.writeLine("const globalEndX = globalStartX + ".concat(I,";")),K.writeLine("const globalStartY = wgY * ".concat(j,";")),K.writeLine("const globalEndY = globalStartY + ".concat(j,";")),K.writeLine("const globalStartZ = wgZ * ".concat(D,";")),K.writeLine("const globalEndZ = globalStartZ + ".concat(D,";")),m&&K.writeLine("let allDone = true;"),K.writeLine("for (let global_id_z = globalStartZ; global_id_z < globalEndZ; global_id_z++) {"),K.indent(),K.writeLine("for (let global_id_y = globalStartY; global_id_y < globalEndY; global_id_y++) {"),K.indent(),K.writeLine("for (let global_id_x = globalStartX; global_id_x < globalEndX; global_id_x++) {"),K.indent(),b&&(K.writeLine("const local_id_x = global_id_x - globalStartX;"),K.writeLine("const local_id_y = global_id_y - globalStartY;"),K.writeLine("const local_id_z = global_id_z - globalStartZ;")),m?(K.writeLine("const local_index = local_id_x + local_id_y * ".concat(I," + local_id_z * ").concat(I*j,";")),K.writeLine("const barrier = ".concat(e.name,"Kernel(").concat(H,");")),K.writeLine("const firstBarrierValue = barrier.next();"),K.writeLine("allDone = allDone && firstBarrierValue.done;"),K.writeLine("barriers[local_index] = barrier;")):K.writeLine("".concat(e.name,"Kernel(").concat(H,");")),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("}"),m&&(K.writeLine("while (!allDone) {"),K.indent(),K.writeLine("allDone = true;"),K.writeLine("for (let local_index = 0; local_index < ".concat(X,"; local_index++) {")),K.indent(),K.writeLine("const barrier = barriers[local_index];"),K.writeLine("const barrierValue = barrier.next();"),K.writeLine("allDone = allDone && barrierValue.done;"),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("}")),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("}"),K.dedent(),K.writeLine("})"),K.toString()}},891:function(__unused_webpack_module,exports,__webpack_require__){var __extends=this&&this.__extends||(extendStatics=function(e,n){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},extendStatics(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),extendStatics,__read=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u};Object.defineProperty(exports,"__esModule",{value:!0}),exports.KernelCPU=void 0;var kernel_1=__webpack_require__(621),KernelCPU=function(_super){function KernelCPU(spec,config,device){var _this=_super.call(this,spec,config,device)||this;return _this._javaScriptCode=(0,kernel_1.getKernelJavaScriptCode)(spec,config),_this._javaScriptFunction=eval(_this._javaScriptCode),_this}return __extends(KernelCPU,_super),KernelCPU.prototype.run=function(e,n,r){var o=this,i=this.getRunEnv(n),a=[],u=[];this.spec.inputs.forEach((function(n,r){return a.push(o.getStorageInputBuffer(n,e[r]?e[r]:null,r,i))})),this.spec.outputs.forEach((function(e,n){var s=o.getStorageOutputBuffer(e,r?r[n]:null,n,i);a.push(s),u.push(s)})),a.push(n);var s=__read(this.getWorkgroupCounts(i),3),c=s[0],p=s[1],l=s[2];return a.push(c),a.push(p),a.push(l),this._javaScriptFunction.apply(null,a),u},KernelCPU.prototype.getStorageInputBuffer=function(e,n,r,o){if(null===n)throw new Error("Missing input buffer #".concat(r," (out of ").concat(this.spec.inputs.length,') named "').concat(e.name,'" in kernel "').concat(this.key,'"'));return n},KernelCPU.prototype.getStorageOutputBuffer=function(e,n,r,o){if(null!==n)return n;var i=(0,kernel_1.getShaderTypeElementByteSize)(e.shaderType)*Math.ceil(this._outputSizeFuncs[r](o));return this.device.alloc(i).getTypedArray((0,kernel_1.shaderTypeToDtype)(e.shaderType))},KernelCPU}(kernel_1.Kernel);exports.KernelCPU=KernelCPU},861:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u};Object.defineProperty(n,"__esModule",{value:!0}),n.KernelWebGPU=void 0;var s=r(621),c=function(e){function KernelWebGPU(n,r,o){var i=e.call(this,n,r,o)||this,a=o.gpuDevice;if(!a)throw new Error("Cannot create a GPU kernel without a GPU device");i._gpuDevice=a;for(var u=[],c=0,p=0;p<n.inputs.length;p++,c++)u.push({binding:c,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}});for(p=0;p<n.outputs.length;p++,c++)u.push({binding:c,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}});u.push({binding:c,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}),i._bindGroupLayout=a.createBindGroupLayout({entries:u}),i._shaderCode=(0,s.getKernelShaderCode)(n,r);var l=a.createShaderModule({code:i._shaderCode});return i._computePipeline=a.createComputePipeline({layout:a.createPipelineLayout({bindGroupLayouts:[i._bindGroupLayout]}),compute:{module:l,entryPoint:"main"}}),i}return i(KernelWebGPU,e),KernelWebGPU.prototype.run=function(e,n,r){for(var o,i,c=this,p=this.getRunEnv(n),l=0,d=0;d<this.spec.parameters.length;d++){var f=this.spec.parameters[d];l+=(0,s.getShaderTypeElementByteSize)(f.shaderType)}var h=this.spec.inputs.map((function(n,r){return c.getStorageInputBuffer(n,e[r]?e[r]:null,r,p)})),y=this.spec.outputs.map((function(e,n){return c.getStorageOutputBuffer(e,r?r[n]:null,n,p)})),v=this._gpuDevice.createBuffer({mappedAtCreation:!0,size:l,usage:GPUBufferUsage.STORAGE}),g=v.getMappedRange();try{for(var w=a(["u32","f32"]),b=w.next();!b.done;b=w.next()){var m=b.value,_=new("u32"===m?Uint32Array:Float32Array)(g);for(d=0;d<this.spec.parameters.length;d++){(f=this.spec.parameters[d]).shaderType===m&&(_[d]=+p[f.name])}}}catch(e){o={error:e}}finally{try{b&&!b.done&&(i=w.return)&&i.call(w)}finally{if(o)throw o.error}}v.unmap();var S=this.createBindGroup(h,v,y),F=u(this.getWorkgroupCounts(p),3),x=F[0],z=F[1],T=F[2],C=this._gpuDevice.createCommandEncoder(),k=C.beginComputePass();k.setPipeline(this._computePipeline),k.setBindGroup(0,S),k.dispatchWorkgroups(x,z,T),k.end();var G=C.finish();return this._gpuDevice.queue.submit([G]),y},KernelWebGPU.prototype.getStorageInputBuffer=function(e,n,r,o){if(null===n)throw new Error("Missing input buffer #".concat(r," (out of ").concat(this.spec.inputs.length,') named "').concat(e.name,'" in kernel "').concat(this.key,'"'));if(n.usage&GPUBufferUsage.STORAGE)return n.unmap(),n;throw new Error("Provided input buffer is not a storage buffer")},KernelWebGPU.prototype.getStorageOutputBuffer=function(e,n,r,o){if(null!==n){if(n.usage&GPUBufferUsage.STORAGE)return n.unmap(),n;throw new Error("Provided output buffer is not a storage buffer")}var i=(0,s.getShaderTypeElementByteSize)(e.shaderType)*Math.ceil(this._outputSizeFuncs[r](o));return this._gpuDevice.createBuffer({mappedAtCreation:!1,size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC})},KernelWebGPU.prototype.createBindGroup=function(e,n,r){for(var o=[],i=0,a=0;a<e.length;a++,i++)o.push({binding:i,resource:{buffer:e[a]}});for(a=0;a<this.spec.outputs.length;a++,i++){var u=r[a];o.push({binding:i,resource:{buffer:u}})}return o.push({binding:i,resource:{buffer:n}}),this._gpuDevice.createBindGroup({layout:this._bindGroupLayout,entries:o})},KernelWebGPU}(s.Kernel);n.KernelWebGPU=c},473:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.registry=void 0,n.registry={};var o=r(916);for(var i in o.kernels)n.registry[i]=o.kernels[i];var a=r(353);for(var u in a.kernels)n.registry[u]=a.kernels[u]},353:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.kernels=void 0,n.kernels={conv2d:{name:"conv2d",config:[{name:"dtype"}],parameters:[{name:"batchSize",shaderType:"u32"},{name:"inputChannels",shaderType:"u32"},{name:"outputChannels",shaderType:"u32"},{name:"inputHeight",shaderType:"u32"},{name:"inputWidth",shaderType:"u32"},{name:"kernelHeight",shaderType:"u32"},{name:"kernelWidth",shaderType:"u32"},{name:"outputHeight",shaderType:"u32"},{name:"outputWidth",shaderType:"u32"}],inputs:[{name:"input",shaderType:"array<f32>"},{name:"weight",shaderType:"array<f32>"}],outputs:[{name:"output",shaderType:"array<f32>",size:"batchSize * outputChannels * outputHeight * outputWidth"}],workgroupSize:[4,4,1],workgroupCount:["outputWidth/4","outputHeight/4",1],shader:"\n    if (global_id.x >= parameters.outputWidth || global_id.y >= parameters.outputHeight) {\n        return;\n    }\n    // input shape = [B, C, H, W]\n    for (var batch = 0u; batch < parameters.batchSize; batch++) {\n        for (var outputChannel = 0u; outputChannel < parameters.outputChannels; outputChannel++) {\n            var result = 0.0;\n            // Do the convolution\n            for (var inputChannel = 0u; inputChannel < parameters.inputChannels; inputChannel++) {\n                for (var kernelY = 0u; kernelY < parameters.kernelHeight; kernelY++) {\n                    for (var kernelX = 0u; kernelX < parameters.kernelWidth; kernelX++) {\n                        var inputY = global_id.y + kernelY;\n                        var inputX = global_id.x + kernelX;\n                        var inputIndex =\n                            batch * parameters.inputChannels * parameters.inputHeight * parameters.inputWidth +\n                            inputChannel * parameters.inputHeight * parameters.inputWidth +\n                            inputY * parameters.inputWidth +\n                            inputX;\n                        var kernelIndex =\n                            outputChannel * parameters.inputChannels * parameters.kernelHeight * parameters.kernelWidth +\n                            inputChannel * parameters.kernelHeight * parameters.kernelWidth +\n                            kernelY * parameters.kernelWidth +\n                            kernelX;\n                        result = result + input[inputIndex] * weight[kernelIndex];\n                    }\n                }\n            }\n            // Output\n            let outputIndex = \n                batch * parameters.outputChannels * parameters.outputHeight * parameters.outputWidth +\n                outputChannel * parameters.outputHeight * parameters.outputWidth +\n                global_id.y * parameters.outputWidth +\n                global_id.x;\n            output[outputIndex] = result;\n        }\n    }\n"},mm:{name:"mm",config:[{name:"resultDtype"}],parameters:[{name:"resultRows",shaderType:"u32"},{name:"resultCols",shaderType:"u32"},{name:"innerDim",shaderType:"u32"},{name:"alpha",shaderType:"f32"}],inputs:[{name:"firstMatrix",shaderType:"array<f32>"},{name:"secondMatrix",shaderType:"array<f32>"}],outputs:[{name:"resultMatrix",shaderType:"array<f32>",size:"resultRows * resultCols"}],workgroupSize:[8,8,1],workgroupCount:["resultRows/8","resultCols/8",1],shader:"\n    if (global_id.x >= parameters.resultRows || global_id.y >= parameters.resultCols) {\n        return;\n    }\n    var result = 0.0;\n    for (var i = 0u; i < parameters.innerDim; i = i + 1u) {\n        let a = global_id.x * parameters.innerDim + i;\n        let b = i * parameters.resultCols + global_id.y;\n        result = result + firstMatrix[a] * secondMatrix[b];\n    }\n    let index = global_id.y + global_id.x * parameters.resultCols;\n    resultMatrix[index] = result;\n"},sumDim:{name:"sumDim",config:[{name:"dtype"},{name:"workgroupSize"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[{name:"dimToSum",shaderType:"u32"},{name:"inputShape",shaderType:"vec3<u32>"},{name:"inputStrides",shaderType:"vec3<u32>"}],outputs:[{name:"output",shaderType:"array<f32>",size:"size"}],workgroupSize:["workgroupSize","workgroupSize","workgroupSize"],workgroupCount:[1,1,1],shader:"\n        // Global index flattening for the reformatted 3D tensor\n        var flatGlobalId: u32 = global_id.x * parameters.inputStrides.x + global_id.y * parameters.inputStrides.y + global_id.z * parameters.inputStrides.z;\n    \n        // Initialize sum\n        var sum: f32 = 0.0;\n    \n        let numReductions: u32 = parameters.inputShape.y;\n    \n        // Sum reduction\n        for (var i: u32 = 0; i < numReductions; i = i + 1) {\n            // Compute the input index by adding the reduction offset to the current flat global index\n            var dataIndex: u32 = flatGlobalId + i * parameters.inputStrides.y;\n    \n            if (dataIndex < input.length()) {\n                // Accumulate the input value into sum\n                sum = sum + input[dataIndex];\n            }\n        }\n    \n        // Write the reduced sum value to output tensor\n        if (flatGlobalId < output.length()) {\n            output[flatGlobalId] = sum;\n        }\n    "}}},916:function(e,n,r){var o,i,a,u,s=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u};Object.defineProperty(n,"__esModule",{value:!0}),n.opKernelSpecs=n.kernels=void 0;var p=r(351),l=r(171);n.kernels={},n.opKernelSpecs=[];try{for(var d=s(Object.entries(l.registry)),f=d.next();!f.done;f=d.next()){var h=c(f.value,2),y=(h[0],h[1]),v=(0,p.opSpecToKernelSpecs)(y);try{for(var g=(a=void 0,s(v)),w=g.next();!w.done;w=g.next()){var b=w.value;n.kernels[b.name]=b,n.opKernelSpecs.push([y,b])}}catch(e){a={error:e}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(a)throw a.error}}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}},32:function(e,n,r){var o=this&&this.__createBinding||(Object.create?function(e,n,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(n,r);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[r]}}),Object.defineProperty(e,o,i)}:function(e,n,r,o){void 0===o&&(o=r),e[o]=n[r]}),i=this&&this.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||o(n,e,r)};Object.defineProperty(n,"__esModule",{value:!0}),n.diffusers=void 0,i(r(776),n),n.diffusers=r(149),i(r(117),n),i(r(96),n)},776:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)});Object.defineProperty(n,"__esModule",{value:!0}),n.Linear=n.GroupNorm=n.ConvTranspose2d=n.Conv2d=n.AvgPooling2d=void 0;var a=r(117),u=function(e){function AvgPooling2d(){return null!==e&&e.apply(this,arguments)||this}return i(AvgPooling2d,e),AvgPooling2d}(a.Module);n.AvgPooling2d=u;var s=function(e){function Conv2d(n,r,o,i,a,u){var s=e.call(this)||this;return s.inChannels=n,s.outChannels=r,s}return i(Conv2d,e),Conv2d}(a.Module);n.Conv2d=s;var c=function(e){function ConvTranspose2d(){return null!==e&&e.apply(this,arguments)||this}return i(ConvTranspose2d,e),ConvTranspose2d}(a.Module);n.ConvTranspose2d=c;var p=function(e){function GroupNorm(n,r){var o=e.call(this)||this;return o.numGroups=n,o.numChannels=r,o}return i(GroupNorm,e),GroupNorm}(a.Module);n.GroupNorm=p;var l=function(e){function Linear(n,r){var o=e.call(this)||this;return o.inChannels=n,o.outChannels=r,o}return i(Linear,e),Linear}(a.Module);n.Linear=l},149:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u},s=this&&this.__spreadArray||function(e,n,r){if(r||2===arguments.length)for(var o,i=0,a=n.length;i<a;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.TimestepEmbedSequential=n.UNetModel=void 0;var c=r(776),p=r(117),l=r(96),d=r(576),f=function(e){function UNetModel(n){var r,o,i,c,d,f=this;if(f=e.call(this)||this,-1===n.numHeads&&-1===n.numHeadChannels)throw new Error("Must specify either numHeads or numHeadChannels");if(-1===n.numHeadChannels&&-1===n.numHeads)throw new Error("Must specify either numHeads or numHeadChannels");f.inChannels=n.inChannels,f.modelChannels=n.modelChannels,f.outChannels=n.outChannels,f.numResBlocks=n.numResBlocks||2,f.attentionResolutions=n.attentionResolutions||[],f.dropout=n.dropout||0,f.channelMult=n.channelMult||[1,2,4,8],f.convResample=void 0===n.convResample||n.convResample,f.numClasses=n.numClasses||null,f.useCheckpoint=n.useCheckpoint||!1,f.dtype=n.dtype||"float32",f.numHeadChannels=n.numHeadChannels||-1;var b=n.contextDim||null,S=n.dims||2,F=n.resblockUpdown||!1,x=n.transformerDepth||1,z=n.useCheckpoint||!1,T=n.useNewAttentionOrder||!1,C=4*n.modelChannels;f.timeEmbed=new p.Sequential([linear(f.modelChannels,C),new l.SiLU,linear(C,C)]),f.inputBlocks=new p.ModuleList([new m(conv_nd(S,f.inChannels,f.modelChannels,3,1,1,f.dtype))]),f._featureSize=f.modelChannels;var k,G=n.numHeads||-1,A=n.numHeadsUpSample||-1,P=0,E=[f.modelChannels],K=f.modelChannels,B=1;try{for(var O=a(f.channelMult.entries()),M=O.next();!M.done;M=O.next()){for(var U=u(M.value,2),L=U[0],I=U[1],j=0;j<f.numResBlocks;j++){var D=[new _(K,C,I*f.modelChannels,S,!1,!1,f.dropout,f.useCheckpoint,void 0,n.useScaleShiftNorm)];K=I*f.modelChannels,f.attentionResolutions.includes(B)&&(-1===f.numHeadChannels?P=K/G:(G=K/f.numHeadChannels,P=f.numHeadChannels),n.useSpatialTransformer?D.push(new w(K,G,P,x,0,b)):D.push(new h(K,G,P,z,T)))}if(L!=f.channelMult.length-1){var N=K;f.inputBlocks.push(new m(F?new _(K,C,N,S,!1,!0,f.dropout,z,void 0,n.useScaleShiftNorm):new y(K,f.convResample,S,N))),K=N,E.push(K),B*=2,f._featureSize+=K}}}catch(e){r={error:e}}finally{try{M&&!M.done&&(o=O.return)&&o.call(O)}finally{if(r)throw r.error}}-1===f.numHeadChannels?P=K/G:(G=K/f.numHeadChannels,P=f.numHeadChannels),f.middleBlock=new m(new _(K,C,K,S,!1,!1,f.dropout,f.useCheckpoint,void 0,n.useScaleShiftNorm),n.useSpatialTransformer?new w(K,G,P,x,0,b):new h(K,G,P,z,T),new _(K,C,K,S,!1,!1,f.dropout,f.useCheckpoint,void 0,n.useScaleShiftNorm)),f._featureSize+=K,f.outputBlocks=new p.ModuleList([]);try{for(var q=a(f.channelMult.entries()),W=q.next();!W.done;W=q.next()){var R=u(W.value,2);for(L=R[0],I=R[1],j=0;j<f.numResBlocks+1;j++){var H=null!==(d=E.pop())&&void 0!==d?d:0;D=[new _(K+H,C,f.modelChannels*I,S,!1,!1,f.dropout,f.useCheckpoint,void 0,n.useScaleShiftNorm)];if(K=f.modelChannels*I,f.attentionResolutions.includes(B)&&(-1===f.numHeadChannels?P=K/G:(G=K/f.numHeadChannels,P=f.numHeadChannels),D.push(n.useSpatialTransformer?new w(K,G,P,x,0,b):new h(K,A,P,z,T))),L>0&&j==f.numResBlocks){N=K;D.push(F?new _(K,C,N,S,!0,!1,f.dropout,f.useCheckpoint,void 0,n.useScaleShiftNorm):new v(K,f.convResample,S,N)),B/=2}f.outputBlocks.push(new(m.bind.apply(m,s([void 0],u(D),!1)))),f._featureSize+=K}}}catch(e){i={error:e}}finally{try{W&&!W.done&&(c=q.return)&&c.call(q)}finally{if(i)throw i.error}}return f.out=new p.Sequential([(k=K,new g(32,k)),new l.SiLU,zeroModule(conv_nd(S,f.modelChannels,f.outChannels,3,1,1,f.dtype))]),f}return i(UNetModel,e),UNetModel.prototype.forward=function(e,n,r,o){var i,u,s,c;if(void 0!==o!=(null!==this.numClasses))throw new Error("Must specify y if and only if numClasses is set (the model is cross-conditional)");var p=[],l=function timestepEmbedding(e,n,r,o,i){void 0===o&&(o=!1);void 0===i&&(i=1e4);throw o?new Error("Not implemented due to missing repeat"):new Error("Not implemented due to missing arange, zerosLike, slicing")}(0,this.modelChannels,this.dtype,!1),f=this.timeEmbed.forward(l);if(null!==this.numClasses&&(1!=(null==o?void 0:o.shape.length)||o.shape[0]!=e.shape[0]))throw new Error("y must be a 1-D batch of labels whose batch size matches x");var h=e;try{for(var y=a(this.inputBlocks),v=y.next();!v.done;v=y.next()){h=v.value.forward(h,f,r),p.push(h)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(u=y.return)&&u.call(y)}finally{if(i)throw i.error}}h=this.middleBlock.forward(h,f,r);try{for(var g=a(this.outputBlocks),w=g.next();!w.done;w=g.next()){var b=w.value;h=(0,d.cat)([h,p.pop()],1),h=b.forward(h,f,r)}}catch(e){s={error:e}}finally{try{w&&!w.done&&(c=g.return)&&c.call(g)}finally{if(s)throw s.error}}return this.out.forward(h)},UNetModel}(p.Module);function conv_nd(e,n,r,o,i,a,u){if(2===e)return new c.Conv2d(n,r,o,i,a,u);throw new Error("conv_nd: dims ".concat(e," not implemented"))}function linear(e,n){return new c.Linear(e,n)}function zeroModule(e){var n,r;try{for(var o=a(e.parameters()),i=o.next();!i.done;i=o.next()){i.value.detach().zero_()}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e}n.UNetModel=f;var h=function(e){function AttentionBlock(n,r,o,i,a){return e.call(this)||this}return i(AttentionBlock,e),AttentionBlock}(p.Module),y=function(e){function Downsample(n,r,o,i,a){return void 0===o&&(o=2),void 0===a&&(a=1),e.call(this)||this}return i(Downsample,e),Downsample}(p.Module),v=function(e){function Upsample(n,r,o,i,a){return void 0===o&&(o=2),void 0===a&&(a=1),e.call(this)||this}return i(Upsample,e),Upsample}(p.Module),g=function(e){function GroupNorm32(n,r){return e.call(this,n,r)||this}return i(GroupNorm32,e),GroupNorm32}(c.GroupNorm),w=function(e){function SpatialTransformer(n,r,o,i,a,u){return void 0===i&&(i=1),void 0===a&&(a=0),void 0===u&&(u=null),e.call(this)||this}return i(SpatialTransformer,e),SpatialTransformer}(p.Module),b=function(e){function TimestepBlock(){return null!==e&&e.apply(this,arguments)||this}return i(TimestepBlock,e),TimestepBlock}(p.Module),m=function(e){function TimestepEmbedSequential(){for(var n,r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s=e.call(this)||this;try{for(var c=a(o.entries()),p=c.next();!p.done;p=c.next()){var l=u(p.value,2),d=l[0],f=l[1];s.addModule(d,f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return s}return i(TimestepEmbedSequential,e),TimestepEmbedSequential.prototype.forward=function(e,n,r){var o,i;try{for(var u=a(this.children),s=u.next();!s.done;s=u.next()){var c=s.value;e=c instanceof b?c.forward(e,n):c(e)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return e},TimestepEmbedSequential}(b);n.TimestepEmbedSequential=m;var _=function(e){function ResBlock(n,r,o,i,a,u,s,c,p,l){return void 0===i&&(i=2),void 0===a&&(a=!1),void 0===u&&(u=!1),void 0===s&&(s=0),void 0===c&&(c=!1),void 0===p&&(p=!1),void 0===l&&(l=!1),e.call(this)||this}return i(ResBlock,e),ResBlock}(b)},117:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__generator||function(e,n){var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(s){return function(c){return function step(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(e,u)}catch(e){s=[6,e],o=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},u=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u},s=this&&this.__values||function(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.Sequential=n.ModuleList=n.Container=n.Parameter=n.Module=void 0;var c=r(784),p=function(){function Module(){this._children=null,this._parameters=null,this._buffers=[],this._nonPersistentBuffersSet=new Set,this._training=!0}return Object.defineProperty(Module.prototype,"namedChildren",{get:function(){if(null===this._children)for(var e in this._children=[],this){var n=this[e];n instanceof Module&&this._children.push([e,n])}return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(Module.prototype,"children",{get:function(){return this.namedChildren.map((function(e){var n=u(e,2);n[0];return n[1]}))},enumerable:!1,configurable:!0}),Object.defineProperty(Module.prototype,"immediateParameters",{get:function(){if(null===this._parameters)for(var e in this._parameters=[],this){var n=this[e];n instanceof l&&this._parameters.push([e,n])}return this._parameters},enumerable:!1,configurable:!0}),Object.defineProperty(Module.prototype,"training",{get:function(){return this._training},enumerable:!1,configurable:!0}),Object.defineProperty(Module.prototype,Symbol.toStringTag,{get:function(){return"Module"},enumerable:!1,configurable:!0}),Module.prototype.toString=function(){var e,n,r=[];try{for(var o=s(this.namedChildren),i=o.next();!i.done;i=o.next()){var a=u(i.value,2),c=a[0],p=a[1].toString().split("\n"),l=1===p.length?p[0]:p[0]+"\n"+p.splice(1).map((function(e){return"  ".concat(e)})).join("\n");r.push("(".concat(c,"): ").concat(l))}}catch(n){e={error:n}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}var d=r,f=this.constructor.name+"(";return d.length>0&&(f+="\n  ".concat(d.join("\n  "),"\n")),f+=")"},Module.prototype.addModule=function(e,n){if(void 0!==this[e])throw new Error("Module already has a child named ".concat(e));if("string"==typeof e&&-1!==e.indexOf("."))throw new Error('Module name cannot contain "."');this[e]=n,this._children=null},Module.prototype.namedModules=function(e,n,r){var o,i,c,p,l,d,f,h,y;return void 0===n&&(n=""),void 0===r&&(r=!0),a(this,(function(a){switch(a.label){case 0:return(e=e||new Set).has(this)?[3,9]:(r&&e.add(this),[4,[n,this]]);case 1:a.sent(),a.label=2;case 2:a.trys.push([2,7,8,9]),o=s(this.namedChildren),i=o.next(),a.label=3;case 3:return i.done?[3,6]:(c=u(i.value,2),p=c[0],(l=c[1])?(d=n?"".concat(n,".").concat(p):"".concat(p),[5,s(l.namedModules(e,d,r))]):[3,5]);case 4:a.sent(),a.label=5;case 5:return i=o.next(),[3,3];case 6:return[3,9];case 7:return f=a.sent(),h={error:f},[3,9];case 8:try{i&&!i.done&&(y=o.return)&&y.call(o)}finally{if(h)throw h.error}return[7];case 9:return[2]}}))},Module.prototype.modules=function(){var e,n,r,o,i,c;return a(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),e=s(this.namedModules()),n=e.next(),a.label=1;case 1:return n.done?[3,4]:(r=u(n.value,2),r[0],[4,r[1]]);case 2:a.sent(),a.label=3;case 3:return n=e.next(),[3,1];case 4:return[3,7];case 5:return o=a.sent(),i={error:o},[3,7];case 6:try{n&&!n.done&&(c=e.return)&&c.call(e)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},Module.prototype._named_members=function(e,n,r,o){var i,c,p,l,d,f,h,y,v,g,w,b,m,_,S,F,x,z,T;return void 0===n&&(n=""),void 0===r&&(r=!0),void 0===o&&(o=!0),a(this,(function(a){switch(a.label){case 0:i=new Set,c=r?this.namedModules(void 0,n,o):[[n,this]],a.label=1;case 1:a.trys.push([1,12,13,14]),p=s(c),l=p.next(),a.label=2;case 2:if(l.done)return[3,11];d=u(l.value,2),f=d[0],h=d[1],y=e(h),a.label=3;case 3:a.trys.push([3,8,9,10]),z=void 0,v=s(y),g=v.next(),a.label=4;case 4:return g.done?[3,7]:(w=u(g.value,2),b=w[0],null==(m=w[1])||i.has(m)?[3,6]:(o&&i.add(m),[4,[f?"".concat(f,".").concat(b):b,m]]));case 5:a.sent(),a.label=6;case 6:return g=v.next(),[3,4];case 7:return[3,10];case 8:return _=a.sent(),z={error:_},[3,10];case 9:try{g&&!g.done&&(T=v.return)&&T.call(v)}finally{if(z)throw z.error}return[7];case 10:return l=p.next(),[3,2];case 11:return[3,14];case 12:return S=a.sent(),F={error:S},[3,14];case 13:try{l&&!l.done&&(x=p.return)&&x.call(p)}finally{if(F)throw F.error}return[7];case 14:return[2]}}))},Module.prototype.namedParameters=function(e,n,r){return void 0===e&&(e=""),void 0===n&&(n=!0),void 0===r&&(r=!0),this._named_members((function(e){return e.immediateParameters}),e,n,r)},Module.prototype.parameters=function(){var e,n,r,o,i,c;return a(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),e=s(this.namedParameters()),n=e.next(),a.label=1;case 1:return n.done?[3,4]:(r=u(n.value,2),r[0],[4,r[1]]);case 2:a.sent(),a.label=3;case 3:return n=e.next(),[3,1];case 4:return[3,7];case 5:return o=a.sent(),i={error:o},[3,7];case 6:try{n&&!n.done&&(c=e.return)&&c.call(e)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},Module.prototype.registerBuffer=function(e,n,r){if(void 0===r&&(r=!0),!e)throw new Error("Buffer name must not be empty.");if(-1!==e.indexOf("."))throw new Error("Buffer name must not contain a period.");if(this._buffers.some((function(n){var r=u(n,2),o=r[0];r[1];return o===e})))throw new Error("Buffer ".concat(e," already registered."));this._buffers.push([e,n]),r?this._nonPersistentBuffersSet.delete(e):this._nonPersistentBuffersSet.add(e)},Module.prototype.namedBuffers=function(e,n,r){return void 0===e&&(e=""),void 0===n&&(n=!0),void 0===r&&(r=!0),this._named_members((function(e){return e._buffers}),e,n,r)},Module.prototype.buffers=function(){var e,n,r,o,i,c;return a(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),e=s(this.namedBuffers()),n=e.next(),a.label=1;case 1:return n.done?[3,4]:(r=u(n.value,2),r[0],[4,r[1]]);case 2:a.sent(),a.label=3;case 3:return n=e.next(),[3,1];case 4:return[3,7];case 5:return o=a.sent(),i={error:o},[3,7];case 6:try{n&&!n.done&&(c=e.return)&&c.call(e)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},Module.prototype.train=function(e){var n,r;void 0===e&&(e=!0),this._training=e;try{for(var o=s(this.children),i=o.next();!i.done;i=o.next()){i.value.train(e)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return this},Module.prototype.eval=function(){return this.train(!1)},Module.prototype.requiresGrad=function(e){var n,r;void 0===e&&(e=!0);try{for(var o=s(this.parameters()),i=o.next();!i.done;i=o.next()){i.value.requiresGrad=e}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return this},Module.prototype.zeroGrad=function(e){var n,r;void 0===e&&(e=!0);try{for(var o=s(this.parameters()),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.grad){if(!e)throw a.grad.gradFunc?a.grad.detach():a.grad.requiresGrad=!1,a.grad.zero_(),new Error("Not implemented: Cannot set gradients to 0. Use setToNull=true instead.");a.grad=null}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return this},Module.prototype.stateDict=function(e,n,r){var o,i;void 0===n&&(n=""),void 0===r&&(r=!0),e=e||{},this._saveToStateDict(e,n,r);try{for(var a=s(this.namedChildren),c=a.next();!c.done;c=a.next()){var p=u(c.value,2),l=p[0],d=p[1];d&&d.stateDict(e,n+l+".",r)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return e},Module.prototype._saveToStateDict=function(e,n,r){var o,i,a,c;try{for(var p=s(this.namedParameters()),l=p.next();!l.done;l=p.next()){var d=u(l.value,2),f=d[0],h=d[1];h&&(e[n+f]=r?h:h.detach())}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}try{for(var y=s(this.namedBuffers()),v=y.next();!v.done;v=y.next()){var g=u(v.value,2),w=g[0],b=g[1];b&&!this._nonPersistentBuffersSet.has(w)&&(e[n+w]=r?b:b.detach())}}catch(e){a={error:e}}finally{try{v&&!v.done&&(c=y.return)&&c.call(y)}finally{if(a)throw a.error}}},Module.prototype.loadStateDict=function(e){!function load(e,n,r){var o,i,a,c;e._loadFromStateDict(n,r);try{for(var p=s(e.namedChildren),l=p.next();!l.done;l=p.next()){var d=u(l.value,2),f=d[0],h=d[1];if(h){var y=r+f+".",v={};try{for(var g=(a=void 0,s(Object.entries(n))),w=g.next();!w.done;w=g.next()){var b=u(w.value,2),m=b[0],_=b[1];m.startsWith(y)&&(v[m]=_)}}catch(e){a={error:e}}finally{try{w&&!w.done&&(c=g.return)&&c.call(g)}finally{if(a)throw a.error}}load(h,v,y)}}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}(this,e,"")},Module.prototype._loadFromStateDict=function(e,n){throw new Error("State dict loading not implemented")},Module}();n.Module=p;var l=function(e){function Parameter(n,r){return void 0===r&&(r=!0),e.call(this,{data:n.storage,dtype:n.dtype,shape:n.shape,strides:n.strides,requiresGrad:r,device:n.device})||this}return i(Parameter,e),Parameter}(c.Tensor);n.Parameter=l;var d=function(e){function Container(){return null!==e&&e.apply(this,arguments)||this}return i(Container,e),Container}(p);n.Container=d;var f=function(e){function ModuleList(n){var r,o;void 0===n&&(n=[]);var i=e.call(this)||this;try{for(var a=s(n.entries()),c=a.next();!c.done;c=a.next()){var p=u(c.value,2),l=p[0],d=p[1];i.addModule(l,d)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}return i(ModuleList,e),Object.defineProperty(ModuleList.prototype,"length",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),ModuleList.prototype[Symbol.iterator]=function(){return this.children[Symbol.iterator]()},ModuleList.prototype.push=function(e){this.addModule(this.children.length,e)},ModuleList}(p);n.ModuleList=f;var h=function(e){function Sequential(n){var r,o,i=e.call(this)||this;try{for(var a=s(n.entries()),c=a.next();!c.done;c=a.next()){var p=u(c.value,2),l=p[0],d=p[1];i.addModule(l,d)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}return i(Sequential,e),Object.defineProperty(Sequential.prototype,"length",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),Sequential.prototype[Symbol.iterator]=function(){return this.children[Symbol.iterator]()},Sequential.prototype.forward=function(e){var n,r;try{for(var o=s(this.children),i=o.next();!i.done;i=o.next()){e=i.value.forward(e)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e},Sequential}(d);n.Sequential=h},96:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)});Object.defineProperty(n,"__esModule",{value:!0}),n.SiLU=n.ReLU=void 0;var a=r(117),u=function(e){function ReLU(){return null!==e&&e.apply(this,arguments)||this}return i(ReLU,e),ReLU.prototype.forward=function(e){return e.relu()},ReLU}(a.Module);n.ReLU=u;var s=function(e){function SiLU(){return null!==e&&e.apply(this,arguments)||this}return i(SiLU,e),SiLU.prototype.forward=function(e){return e.silu()},SiLU}(a.Module);n.SiLU=s},171:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.registry=void 0,n.registry=[{name:"abs",aliases:["absolute"],type:"unary",forward:"output = abs(input)",backward:"inputGrad = input == 0 ? 0 : (input > 0 ? outputGrad : -outputGrad)"},{name:"acos",aliases:["arccos"],type:"unary",forward:"output = acos(input)",backward:"inputGrad = -outputGrad / sqrt(1 - input * input)"},{name:"acosh",aliases:["arccosh"],type:"unary",forward:"output = acosh(input)",backward:"inputGrad = outputGrad / sqrt(input * input - 1)"},{name:"add",type:"binary",alpha:!0,forward:"output = input + other",backward:"inputGrad = outputGrad; otherGrad = outputGrad"},{name:"asin",aliases:["arcsin"],type:"unary",forward:"output = asin(input)",backward:"inputGrad = outputGrad / sqrt(1 - input * input)"},{name:"asinh",aliases:["arcsinh"],type:"unary",forward:"output = asinh(input)",backward:"inputGrad = outputGrad / sqrt(input * input + 1)"},{name:"atan",aliases:["arctan"],type:"unary",forward:"output = atan(input)",backward:"inputGrad = outputGrad / (input * input + 1)"},{name:"atan2",aliases:["arctan2"],type:"binary",forward:"output = atan2(input, other)",backward:"inputGrad = outputGrad * other / (input * input + other * other); otherGrad = -outputGrad * input / (input * input + other * other)"},{name:"ceil",type:"unary",forward:"output = ceil(input)",backward:"inputGrad = 0"},{name:"copysign",type:"binary",forward:"output = other >= 0 ? abs(input) : -abs(input)",backward:"var dir = other >= 0 ? (input >= 0 ? 1.0 : -1.0) : (input >= 0 ? -1.0 : 1.0); inputGrad = input == 0.0 ? 0.0 : outputGrad * dir; otherGrad = 0"},{name:"cos",type:"unary",forward:"output = cos(input)",backward:"inputGrad = -outputGrad * sin(input)"},{name:"cosh",type:"unary",forward:"output = cosh(input)",backward:"inputGrad = outputGrad * sinh(input)"},{name:"deg2rad",type:"unary",forward:"output = input * 0.017453292519943295",backward:"inputGrad = outputGrad * 0.017453292519943295"},{name:"div",aliases:["divide"],type:"binary",alpha:!0,forward:"output = input / other",backward:"inputGrad = outputGrad / other; otherGrad = -outputGrad * input / (other * other)"},{name:"exp",type:"unary",forward:"output = exp(input)",backward:"inputGrad = outputGrad * exp(input)"},{name:"exp2",type:"unary",forward:"output = exp2(input)",backward:"inputGrad = outputGrad * exp2(input) * 0.6931471805599453"},{name:"expm1",type:"unary",forward:"output = exp(input) - 1.0",backward:"inputGrad = outputGrad * exp(input)"},{name:"floor",type:"unary",forward:"output = floor(input)",backward:"inputGrad = 0"},{name:"frac",type:"unary",forward:"output = input >= 0.0 ? fract(input) : -fract(-input)",backward:"inputGrad = outputGrad"},{name:"hypot",type:"binary",forward:"output = sqrt(input * input + other * other)",backward:"inputGrad = outputGrad * input / sqrt(input * input + other * other); otherGrad = outputGrad * other / sqrt(input * input + other * other)"},{name:"ldexp",type:"binary",forward:"output = input * pow(2.0, other)",backward:"var out = pow(2.0, other); inputGrad = outputGrad * out; otherGrad = outputGrad * input * out * 0.6931471805599453"},{name:"log",type:"unary",forward:"output = log(input)",backward:"inputGrad = outputGrad / input"},{name:"log10",type:"unary",forward:"output = log(input) * 0.4342944819032518",backward:"inputGrad = outputGrad / (input * 2.302585092994046)"},{name:"log1p",type:"unary",forward:"output = log(input + 1.0)",backward:"inputGrad = outputGrad / (input + 1.0)"},{name:"log2",type:"unary",forward:"output = log2(input)",backward:"inputGrad = outputGrad / (input * 0.6931471805599453)"},{name:"logaddexp",type:"binary",forward:"output = log(exp(input) + exp(other))",backward:"var ein = exp(input); var eoth = exp(other); var addeinv = outputGrad/(ein + eoth); inputGrad = addeinv * ein; otherGrad = addeinv * eoth"},{name:"logaddexp2",type:"binary",forward:"output = log2(exp2(input) + exp2(other))",backward:"var ein = exp2(input); var eoth = exp2(other); var sum_ein_eoth = ein + eoth; inputGrad = outputGrad * (ein / sum_ein_eoth); otherGrad = outputGrad * (eoth / sum_ein_eoth );"},{name:"mul",aliases:["multiply"],type:"binary",alpha:!0,forward:"output = input * other",backward:"inputGrad = outputGrad * other; otherGrad = outputGrad * input"},{name:"neg",aliases:["negative"],type:"unary",forward:"output = -input",backward:"inputGrad = -outputGrad"},{name:"positive",type:"unary",forward:"output = input",backward:"inputGrad = outputGrad"},{name:"pow",type:"binary",forward:"output = pow(input, other)",backward:"inputGrad = outputGrad * other * pow(input, other - 1.0); otherGrad = outputGrad * pow(input, other) * log(input)"},{name:"rad2deg",type:"unary",forward:"output = input * 57.29577951308232",backward:"inputGrad = outputGrad * 57.29577951308232"},{name:"reciprocal",type:"unary",forward:"output = 1.0 / input",backward:"inputGrad = -outputGrad / (input * input)"},{name:"relu",nnName:"ReLU",nnOp:!0,type:"unary",forward:"output = max(input, 0.0)",backward:"inputGrad = input > 0.0 ? outputGrad : 0.0"},{name:"round",type:"unary",forward:"output = round(input)",backward:"inputGrad = 0"},{name:"rsqrt",type:"unary",forward:"output = 1.0 / sqrt(input)",backward:"inputGrad = -outputGrad / (2.0 * sqrt(input) * input)"},{name:"sigmoid",type:"unary",forward:"output = 1.0 / (1.0 + exp(-input))",backward:"var out = 1.0 / (1.0 + exp(-input)); inputGrad = outputGrad * out * (1.0 - out)"},{name:"sign",type:"unary",forward:"output = sign(input)",backward:"inputGrad = 0"},{name:"silu",nnName:"SiLU",torchName:"torch.nn.functional.silu",nnOp:!0,type:"unary",forward:"output = input / (1.0 + exp(-input))",backward:"var out = 1.0 / (1.0 + exp(-input)); inputGrad = outputGrad * (out + input * out * (1.0 - out))"},{name:"sin",type:"unary",forward:"output = sin(input)",backward:"inputGrad = outputGrad * cos(input)"},{name:"sinc",type:"unary",forward:"var inpi = input * 3.141592653589793; output = input == 0.0 ? 1.0 : sin(inpi) / inpi",backward:"var inpi = input * 3.141592653589793; inputGrad = input == 0.0 ? 0.0 : (outputGrad * 3.141592653589793 * (inpi*cos(inpi) - sin(inpi)) / (inpi*inpi))"},{name:"sinh",type:"unary",forward:"output = sinh(input)",backward:"inputGrad = outputGrad * cosh(input)"},{name:"sqrt",type:"unary",forward:"output = sqrt(input)",backward:"inputGrad = outputGrad / (2.0 * sqrt(input))"},{name:"square",type:"unary",forward:"output = input * input",backward:"inputGrad = outputGrad * 2.0 * input"},{name:"sub",aliases:["subtract"],type:"binary",alpha:!0,forward:"output = input - other",backward:"inputGrad = outputGrad; otherGrad = -outputGrad"},{name:"tan",type:"unary",forward:"output = tan(input)",backward:"inputGrad = outputGrad / (cos(input) * cos(input))",precision:5},{name:"tanh",type:"unary",forward:"output = tanh(input)",backward:"inputGrad = outputGrad * (1.0 - tanh(input) * tanh(input))"},{name:"trunc",aliases:["fix"],type:"unary",forward:"output = trunc(input)",backward:"inputGrad = 0"},{name:"xlogy",type:"binary",forward:"output = input == 0.0 ? 0.0 : input * log(other)",backward:"inputGrad = input == 0.0 ? 0.0 : outputGrad * log(other); otherGrad = input == 0.0 ? 0.0 : outputGrad * (input / other);"},{name:"all",type:"reduction",combineOp:"&&",init:"output = 1",forward:"output = output && input",backward:"inputGrad = output ? outputGrad : 0.0"},{name:"any",type:"reduction",combineOp:"||",init:"output = 0",forward:"output = output || input",backward:"inputGrad = output ? outputGrad : 0.0"},{name:"mean",type:"reduction",combineOp:"+",init:"output = 0.0",forward:"output = output + input",reduce:"output = output / inputSize",backward:"inputGrad = outputGrad / inputSize"},{name:"norm",type:"reduction",combineOp:"+",init:"output = 0.0",forward:"output = output + input * input",reduce:"output = sqrt(output)",backward:"inputGrad = outputGrad * input / output"},{name:"prod",type:"reduction",combineOp:"*",init:"output = 1.0",forward:"output = output * input",backward:"inputGrad = outputGrad * output / input"},{name:"sum",type:"reduction",combineOp:"+",init:"output = 0.0",forward:"output = output + input",backward:"inputGrad = outputGrad"},{name:"countNonzero",type:"reduction",combineOp:"+",init:"output = 0.0",forward:"output = output + (input != 0)"}]},351:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.opSpecToKernelSpecs=n.CodeWriter=void 0;var o=r(877),i=function(){function CodeWriter(){this.indentLevel=0,this.lines=[]}return CodeWriter.prototype.indent=function(){this.indentLevel++},CodeWriter.prototype.dedent=function(){this.indentLevel--},CodeWriter.prototype.writeLine=function(e){this.lines.push("    ".repeat(this.indentLevel)+e)},CodeWriter.prototype.toString=function(){return this.lines.join("\n")},CodeWriter}();function getReductionKernelSpec(e){var n=(0,o.exprCodeToWebGLShader)(e.init,{input:"input[global_id.x]",output:"accumulator"}),r=(0,o.exprCodeToWebGLShader)(e.forward,{input:"input[i]",output:"accumulator"}),i=void 0===e.reduce?"":(0,o.exprCodeToWebGLShader)(e.reduce,{input:"input[i]",output:"accumulator"}),a="\n    var ".concat(n,";\n    // Load inputData into local memory\n    for (var i = local_id.x; i < parameters.size; i += $$workgroupSize$$) {\n        ").concat(r,";\n    }\n    // Write partial group sum to outputData\n    output[local_id.x] = accumulator;\n\n    workgroupBarrier(); // Make sure all threads have completed summation\n\n    // First thread sums up results from all other threads\n    if (local_id.x == 0u) {\n        var numToSum = min(parameters.size, $$workgroupSize$$u);\n        for (var i = 1u; i < numToSum; i++) {\n            accumulator ").concat(e.combineOp,"= output[i];\n        }\n        // Store final reduction in the first element of result array\n        ").concat(i,";\n        output[0] = accumulator;\n    }\n");return{name:e.name,config:[{name:"dtype"},{name:"workgroupSize"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[{name:"input",shaderType:"array<f32>"}],outputs:[{name:"output",shaderType:"array<f32>",size:"workgroupSize"}],workgroupSize:["workgroupSize",1,1],workgroupCount:["size/workgroupSize",1,1],shader:a}}function getBinaryKernelSpec(e){var n=(0,o.exprCodeToWebGLShader)(e.forward,{input:"input[global_id.x]",other:"other[global_id.x]",output:"output[global_id.x]"}),r="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(n,";");return{name:e.name,config:[{name:"dtype"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[{name:"input",shaderType:"array<f32>"},{name:"other",shaderType:"array<f32>"}],outputs:[{name:"output",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:r}}function getBinaryInplaceKernelSpec(e){var n=(0,o.parseCode)(e.forward),r=(0,o.substituteIdentifiers)(n,{input:"input[global_id.x]",other:"other[global_id.x]",output:"input[global_id.x]"}),i=(0,o.exprNodeToWebGLShader)(r),a="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(i,";");return{name:e.name+"_",config:[{name:"dtype"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[{name:"other",shaderType:"array<f32>"}],outputs:[{name:"input",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:a}}function getUnaryKernelSpec(e){var n=(0,o.parseCode)(e.forward),r=(0,o.substituteIdentifiers)(n,{input:"input[global_id.x]",output:"output[global_id.x]"}),i=(0,o.exprNodeToWebGLShader)(r),a="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(i,";");return{name:e.name,config:[{name:"dtype"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[{name:"input",shaderType:"array<f32>"}],outputs:[{name:"output",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:a}}function getUnaryInplaceKernelSpec(e){var n=(0,o.parseCode)(e.forward),r=(0,o.substituteIdentifiers)(n,{input:"input[global_id.x]",output:"input[global_id.x]"}),i=(0,o.exprNodeToWebGLShader)(r),a="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(i,";");return{name:e.name+"_",config:[{name:"dtype"}],parameters:[{name:"size",shaderType:"u32"}],inputs:[],outputs:[{name:"input",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:a}}n.CodeWriter=i,n.opSpecToKernelSpecs=function opSpecToKernelSpecs(e){return"reduction"==e.type?function getReductionKernelSpecs(e){var n=[getReductionKernelSpec(e)];e.backward;return n}(e):"binary"==e.type?function getBinaryKernelSpecs(e){var n=[getBinaryKernelSpec(e),getBinaryInplaceKernelSpec(e)];e.backward&&n.push(function getBinaryGradKernelSpec(e,n){var r=[{name:"size",shaderType:"u32"}],i=(0,o.parseCode)(n),a={input:"input[global_id.x]",inputGrad:"inputGrad[global_id.x]",output:"output[global_id.x]",outputGrad:"outputGrad[global_id.x]",other:"other[global_id.x]",otherGrad:"otherGrad[global_id.x]"},u=(0,o.substituteIdentifiers)(i,a),s=(0,o.exprNodeToWebGLShader)(u),c="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(s,";");return{name:e.name+"Grad",config:[{name:"dtype"}],parameters:r,inputs:[{name:"input",shaderType:"array<f32>"},{name:"other",shaderType:"array<f32>"},{name:"outputGrad",shaderType:"array<f32>"}],outputs:[{name:"inputGrad",shaderType:"array<f32>",size:"size"},{name:"otherGrad",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:c}}(e,e.backward));return n}(e):function getUnaryKernelSpecs(e){var n=[getUnaryKernelSpec(e),getUnaryInplaceKernelSpec(e)];e.backward&&n.push(function getUnaryGradKernelSpec(e,n){var r=[{name:"size",shaderType:"u32"}],i=(0,o.parseCode)(n),a={input:"input[global_id.x]",inputGrad:"inputGrad[global_id.x]",output:"output[global_id.x]",outputGrad:"outputGrad[global_id.x]"},u=(0,o.substituteIdentifiers)(i,a),s=(0,o.exprNodeToWebGLShader)(u),c="\n        if (global_id.x >= parameters.size) {\n            return;\n        }\n        ".concat(s,";");return{name:e.name+"Grad",config:[{name:"dtype"}],parameters:r,inputs:[{name:"input",shaderType:"array<f32>"},{name:"outputGrad",shaderType:"array<f32>"}],outputs:[{name:"inputGrad",shaderType:"array<f32>",size:"size"}],workgroupSize:[64,1,1],workgroupCount:["size/8",1,1],shader:c}}(e,e.backward));return n}(e)}},716:function(e,n,r){var o=this&&this.__createBinding||(Object.create?function(e,n,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(n,r);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[r]}}),Object.defineProperty(e,o,i)}:function(e,n,r,o){void 0===o&&(o=r),e[o]=n[r]}),i=this&&this.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||o(n,e,r)};Object.defineProperty(n,"__esModule",{value:!0}),i(r(576),n),i(r(833),n)},576:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tensor=n.t=n.mm=n.conv2d=n.cat=void 0;var o=r(784),i=r(510);n.cat=function cat(e,n){throw new Error("cat not implemented yet")},n.conv2d=function conv2d(e,n,r,o,a){if((0,i.shouldCreateGradient)(e,n))throw new Error("conv2d gradient not supported yet");if(4!==e.shape.length||4!==n.shape.length)throw new Error("Expected image tensor, got ".concat(e.shape," and kernel ").concat(n.shape));if(e.shape[1]!==n.shape[1])throw new Error("Expected number of chennels in input image to match number of channels in kernel, got ".concat(e.shape," and ").concat(n.shape));var u={batchSize:e.shape[0],inputChannels:e.shape[1],outputChannels:n.shape[0],inputHeight:e.shape[2],inputWidth:e.shape[3],kernelHeight:n.shape[2],kernelWidth:n.shape[3],outputHeight:e.shape[2]-n.shape[2]+1,outputWidth:e.shape[3]-n.shape[3]+1};return e.runKernel("conv2d",{dtype:e.dtype},u,[[u.batchSize,u.outputChannels,u.outputHeight,u.outputWidth]],n)[0]},n.mm=function mm(e,n){if((0,i.shouldCreateGradient)(e,n))throw new Error("mm gradient not supported yet");if(2!==e.shape.length||2!==n.shape.length)throw new Error("Expected 2D tensors, got ".concat(e.shape," and ").concat(n.shape));if(e.shape[1]!==n.shape[0])throw new Error("Expected tensors inner dimensions to be compatible, got ".concat(e.shape," and ").concat(n.shape));var r={resultRows:e.shape[0],resultCols:n.shape[1],innerDim:e.shape[1],alpha:1};return e.runKernel("mm",{resultDtype:e.dtype},r,[[r.resultRows,r.resultCols]],n)[0]},n.t=function t(e){if(2!==e.shape.length)throw new Error("Expected 2D tensor, got ".concat(e.shape));if((0,i.shouldCreateGradient)(e))throw new Error("t gradient not supported yet");var n=e.shape.slice();n.reverse();var r=e.strides.slice();return r.reverse(),e.withShape(n,r)},n.tensor=function tensor(e,n,r,i){return new o.Tensor(e,n,r,i)}},399:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.reduction=n.binaryWithAlpha=n.binary=n.unaryWithAlpha=n.unary=void 0;var o=r(510);n.unary=function unary(e,n){return(0,o.shouldCreateGradient)(n)?e.apply(n):e.forward([n])},n.unaryWithAlpha=function unaryWithAlpha(e,n,r){return(0,o.shouldCreateGradient)(n)?e.apply(n,r):e.forward([n,r])},n.binary=function binary(e,n,r){if(n.shape.length!==r.shape.length)throw new Error("Shape dimensions must match. Got ".concat(n.shape," and ").concat(r.shape));return(0,o.shouldCreateGradient)(n)?e.apply(n,r):e.forward([n,r])},n.binaryWithAlpha=function binaryWithAlpha(e,n,r,i){if(n.shape.length!==r.shape.length)throw new Error("Shape dimensions must match. Got ".concat(n.shape," and ").concat(r.shape));return(0,o.shouldCreateGradient)(n)?e.apply(n,r,i):e.forward([n,r,i])},n.reduction=function reduction(e,n,r,i){return(0,o.shouldCreateGradient)(n)?e.apply(n,r,i):e.forward([n,r,i])}},833:(e,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.sin=n.silu=n.sign=n.sigmoid=n.rsqrt=n.round=n.relu=n.reciprocal=n.rad2deg=n.pow=n.positive=n.negative=n.neg=n.multiply=n.mul=n.logaddexp2=n.logaddexp=n.log2=n.log1p=n.log10=n.log=n.ldexp=n.hypot=n.frac=n.floor=n.expm1=n.exp2=n.exp=n.divide=n.div=n.deg2rad=n.cosh=n.cos=n.copysign=n.ceil=n.arctan2=n.atan2=n.arctan=n.atan=n.arcsinh=n.asinh=n.arcsin=n.asin=n.add=n.arccosh=n.acosh=n.arccos=n.acos=n.absolute=n.abs=void 0,n.countNonzero=n.sum=n.prod=n.norm=n.mean=n.any=n.all=n.xlogy=n.fix=n.trunc=n.tanh=n.tan=n.subtract=n.sub=n.square=n.sqrt=n.sinh=n.sinc=void 0;var o=r(146),i=r(399);function abs(e){return(0,i.unary)(o.AbsFunction,e)}function acos(e){return(0,i.unary)(o.AcosFunction,e)}function acosh(e){return(0,i.unary)(o.AcoshFunction,e)}function asin(e){return(0,i.unary)(o.AsinFunction,e)}function asinh(e){return(0,i.unary)(o.AsinhFunction,e)}function atan(e){return(0,i.unary)(o.AtanFunction,e)}function atan2(e,n){return(0,i.binary)(o.Atan2Function,e,n)}function div(e,n,r){return(0,i.binaryWithAlpha)(o.DivFunction,e,n,r)}function mul(e,n,r){return(0,i.binaryWithAlpha)(o.MulFunction,e,n,r)}function neg(e){return(0,i.unary)(o.NegFunction,e)}function sub(e,n,r){return(0,i.binaryWithAlpha)(o.SubFunction,e,n,r)}function trunc(e){return(0,i.unary)(o.TruncFunction,e)}n.abs=abs,n.absolute=function absolute(e){return abs(e)},n.acos=acos,n.arccos=function arccos(e){return acos(e)},n.acosh=acosh,n.arccosh=function arccosh(e){return acosh(e)},n.add=function add(e,n,r){return(0,i.binaryWithAlpha)(o.AddFunction,e,n,r)},n.asin=asin,n.arcsin=function arcsin(e){return asin(e)},n.asinh=asinh,n.arcsinh=function arcsinh(e){return asinh(e)},n.atan=atan,n.arctan=function arctan(e){return atan(e)},n.atan2=atan2,n.arctan2=function arctan2(e,n){return atan2(e,n)},n.ceil=function ceil(e){return(0,i.unary)(o.CeilFunction,e)},n.copysign=function copysign(e,n){return(0,i.binary)(o.CopysignFunction,e,n)},n.cos=function cos(e){return(0,i.unary)(o.CosFunction,e)},n.cosh=function cosh(e){return(0,i.unary)(o.CoshFunction,e)},n.deg2rad=function deg2rad(e){return(0,i.unary)(o.Deg2radFunction,e)},n.div=div,n.divide=function divide(e,n,r){return div(e,n,r)},n.exp=function exp(e){return(0,i.unary)(o.ExpFunction,e)},n.exp2=function exp2(e){return(0,i.unary)(o.Exp2Function,e)},n.expm1=function expm1(e){return(0,i.unary)(o.Expm1Function,e)},n.floor=function floor(e){return(0,i.unary)(o.FloorFunction,e)},n.frac=function frac(e){return(0,i.unary)(o.FracFunction,e)},n.hypot=function hypot(e,n){return(0,i.binary)(o.HypotFunction,e,n)},n.ldexp=function ldexp(e,n){return(0,i.binary)(o.LdexpFunction,e,n)},n.log=function log(e){return(0,i.unary)(o.LogFunction,e)},n.log10=function log10(e){return(0,i.unary)(o.Log10Function,e)},n.log1p=function log1p(e){return(0,i.unary)(o.Log1pFunction,e)},n.log2=function log2(e){return(0,i.unary)(o.Log2Function,e)},n.logaddexp=function logaddexp(e,n){return(0,i.binary)(o.LogaddexpFunction,e,n)},n.logaddexp2=function logaddexp2(e,n){return(0,i.binary)(o.Logaddexp2Function,e,n)},n.mul=mul,n.multiply=function multiply(e,n,r){return mul(e,n,r)},n.neg=neg,n.negative=function negative(e){return neg(e)},n.positive=function positive(e){return(0,i.unary)(o.PositiveFunction,e)},n.pow=function pow(e,n){return(0,i.binary)(o.PowFunction,e,n)},n.rad2deg=function rad2deg(e){return(0,i.unary)(o.Rad2degFunction,e)},n.reciprocal=function reciprocal(e){return(0,i.unary)(o.ReciprocalFunction,e)},n.relu=function relu(e){return(0,i.unary)(o.ReluFunction,e)},n.round=function round(e){return(0,i.unary)(o.RoundFunction,e)},n.rsqrt=function rsqrt(e){return(0,i.unary)(o.RsqrtFunction,e)},n.sigmoid=function sigmoid(e){return(0,i.unary)(o.SigmoidFunction,e)},n.sign=function sign(e){return(0,i.unary)(o.SignFunction,e)},n.silu=function silu(e){return(0,i.unary)(o.SiluFunction,e)},n.sin=function sin(e){return(0,i.unary)(o.SinFunction,e)},n.sinc=function sinc(e){return(0,i.unary)(o.SincFunction,e)},n.sinh=function sinh(e){return(0,i.unary)(o.SinhFunction,e)},n.sqrt=function sqrt(e){return(0,i.unary)(o.SqrtFunction,e)},n.square=function square(e){return(0,i.unary)(o.SquareFunction,e)},n.sub=sub,n.subtract=function subtract(e,n,r){return sub(e,n,r)},n.tan=function tan(e){return(0,i.unary)(o.TanFunction,e)},n.tanh=function tanh(e){return(0,i.unary)(o.TanhFunction,e)},n.trunc=trunc,n.fix=function fix(e){return trunc(e)},n.xlogy=function xlogy(e,n){return(0,i.binary)(o.XlogyFunction,e,n)},n.all=function all(e){return(0,i.unary)(o.AllFunction,e)},n.any=function any(e){return(0,i.unary)(o.AnyFunction,e)},n.mean=function mean(e){return(0,i.unary)(o.MeanFunction,e)},n.norm=function norm(e){return(0,i.unary)(o.NormFunction,e)},n.prod=function prod(e){return(0,i.unary)(o.ProdFunction,e)},n.sum=function sum(e){return(0,i.unary)(o.SumFunction,e)},n.countNonzero=function countNonzero(e){return(0,i.unary)(o.CountNonzeroFunction,e)}},610:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.defaultStrides=n.shapeSize=n.getShape=void 0,n.getShape=function getShape(e){return"number"==typeof e?[e]:e},n.shapeSize=function shapeSize(e){return 0===e.length?1:1===e.length?e[0]:e.reduce((function(e,n){return e*n}))},n.defaultStrides=function defaultStrides(e){for(var n=[],r=1,o=e.length-1;o>=0;o--)n[o]=r,r*=e[o];return n}},912:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=Promise))((function(i,a){function fulfilled(e){try{step(o.next(e))}catch(e){a(e)}}function rejected(e){try{step(o.throw(e))}catch(e){a(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(n){n(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,n||[])).next())}))},u=this&&this.__generator||function(e,n){var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(s){return function(c){return function step(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(e,u)}catch(e){s=[6,e],o=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.newTypedArrayFromArray=n.newTypedArrayForDtype=n.GPUBufferStorage=n.ArrayBufferStorage=n.UntypedStorage=void 0;var s=r(521),c=r(610),p=function(){function UntypedStorage(){}return UntypedStorage.prototype.getTypedArray=function(e){var n=this.mappedArrayBuffer;if(null===n)throw new Error("Storage is not mapped");if(e in s.dtypeArrayCtors)return new s.dtypeArrayCtors[e](n);throw new Error("Unsupported dtype: ".concat(e))},UntypedStorage}();n.UntypedStorage=p;var l=function(e){function ArrayBufferStorage(n){var r=e.call(this)||this;if("number"==typeof n)r._buffer=new ArrayBuffer(n);else if(n instanceof ArrayBuffer)r._buffer=n;else if(n instanceof Uint8Array)r._buffer=n.buffer;else if(n instanceof Int32Array)r._buffer=n.buffer;else{if(!(n instanceof Float32Array))throw new Error("Invalid constructor argument for ArrayBufferStorage. Expected number of bytes, ArrayBuffer, or a TypedArray. Got ".concat(n," (").concat(n.constructor.name,")"));r._buffer=n.buffer}return r}return i(ArrayBufferStorage,e),Object.defineProperty(ArrayBufferStorage.prototype,"cpuBuffer",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(ArrayBufferStorage.prototype,"byteSize",{get:function(){return this._buffer.byteLength},enumerable:!1,configurable:!0}),Object.defineProperty(ArrayBufferStorage.prototype,"mappedArrayBuffer",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(ArrayBufferStorage.prototype,"isMapped",{get:function(){return!0},enumerable:!1,configurable:!0}),ArrayBufferStorage.prototype.mapReadAsync=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},ArrayBufferStorage.prototype.unmap=function(){},ArrayBufferStorage.prototype.destroy=function(){},ArrayBufferStorage}(p);n.ArrayBufferStorage=l;var d=function(e){function GPUBufferStorage(n,r,o){var i=e.call(this)||this;if(i._mappedArrayBuffer=null,i._device=r,n instanceof GPUBuffer)switch(i._buffer=n,i._buffer.mapState){case"mapped":i._mappedArrayBuffer=[i._buffer,null];break;case"unmapped":i._mappedArrayBuffer=null;break;case"pending":throw new Error("GPUBuffer is pending. Please wait for it to finish mapping before creating a GPUBufferStorage with it.")}else{if("number"!=typeof n||void 0===o||void 0===r)throw new Error("Invalid constructor arguments for GPUBufferStorage. Expected GPUBuffer, or byteSize, usage, and device. Got ".concat(n," (").concat(n.constructor.name,")"));i._buffer=r.createBuffer({mappedAtCreation:!0,size:n,usage:o}),i._mappedArrayBuffer=[i._buffer,null]}return i}return i(GPUBufferStorage,e),Object.defineProperty(GPUBufferStorage.prototype,"byteSize",{get:function(){return this._buffer.size},enumerable:!1,configurable:!0}),Object.defineProperty(GPUBufferStorage.prototype,"gpuBuffer",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(GPUBufferStorage.prototype,"gpuDevice",{get:function(){return this._device},enumerable:!1,configurable:!0}),Object.defineProperty(GPUBufferStorage.prototype,"mappedArrayBuffer",{get:function(){if(null!==this._mappedArrayBuffer){var e=this._mappedArrayBuffer[1];return null===e&&(e=this._mappedArrayBuffer[0].getMappedRange(),this._mappedArrayBuffer[1]=e),e}return null},enumerable:!1,configurable:!0}),Object.defineProperty(GPUBufferStorage.prototype,"isMapped",{get:function(){return"mapped"===this._buffer.mapState},enumerable:!1,configurable:!0}),GPUBufferStorage.prototype.mapReadAsync=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return this.isMapped?[2]:(e=this._buffer,0==(this._buffer.usage&GPUBufferUsage.MAP_READ)&&(e=this.copyBufferToReadableBuffer()),[4,e.mapAsync(GPUMapMode.READ)]);case 1:if(n.sent(),"mapped"!==e.mapState)throw new Error("GPUBuffer failed to map");return this._mappedArrayBuffer=[e,null],[2]}}))}))},GPUBufferStorage.prototype.unmap=function(){this._mappedArrayBuffer=null,this._buffer.unmap()},GPUBufferStorage.prototype.destroy=function(){this._mappedArrayBuffer=null,this._buffer.destroy()},GPUBufferStorage.prototype.copyBufferToReadableBuffer=function(){var e=this._buffer.size,n=this._device.createBuffer({mappedAtCreation:!1,size:e,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),r=this._device.createCommandEncoder();r.copyBufferToBuffer(this._buffer,0,n,0,e);var o=r.finish();return this._device.queue.submit([o]),n},GPUBufferStorage}(p);n.GPUBufferStorage=d,n.newTypedArrayForDtype=function newTypedArrayForDtype(e,n){switch(n){case"uint8":return new Uint8Array(e);case"int32":return new Int32Array(e);case"float32":return new Float32Array(e);default:throw new Error("Unsupported dtype: ".concat(n))}},n.newTypedArrayFromArray=function newTypedArrayFromArray(e,n,r){var o=[];null!==e&&function getShape(e){"number"!=typeof e&&(o.push(e.length),getShape(e[0]))}(e);var i=(0,c.defaultStrides)(o),a=((0,c.shapeSize)(o),r.allocFor(o,n)),u=a.getTypedArray(n),s=0;return null!==e&&function flatten(e){for(var n=0;n<e.length;n++){var r=e[n];if("number"==typeof r){for(var o=0;o<e.length;o++)u[s]=e[o],s++;return}if(!(r instanceof Array))throw new Error("Invalid data type: ".concat(r," (").concat(r.constructor.name,")"));flatten(r)}}(e),{storage:a,shape:o,strides:i}}},784:function(e,n,r){var o,i=this&&this.__extends||(o=function(e,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},o(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=Promise))((function(i,a){function fulfilled(e){try{step(o.next(e))}catch(e){a(e)}}function rejected(e){try{step(o.throw(e))}catch(e){a(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(n){n(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,n||[])).next())}))},u=this&&this.__generator||function(e,n){var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(s){return function(c){return function step(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(e,u)}catch(e){s=[6,e],o=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__read||function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,a=r.call(e),u=[];try{for(;(void 0===n||n-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return u},c=this&&this.__spreadArray||function(e,n,r){if(r||2===arguments.length)for(var o,i=0,a=n.length;i<a;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.Tensor=void 0;var p=r(233),l=r(610),d=r(357),f=r(521),h=r(912),y=r(833),v=r(576),g=function(e){function Tensor(n,r,o,i){var a=e.call(this)||this;a._requiresGrad=!1,a.grad=null;var u=(0,p.getDevice)(o),s=(0,f.getDtype)(r);if(null===n)throw new Error("Cannot create tensor from null");if(n instanceof Array){var c=(0,h.newTypedArrayFromArray)(n,s,u);a._storage=c.storage,a._dtype=s,a._shape=c.shape,a._strides=c.strides}else{if(!n.hasOwnProperty("data"))throw new Error("Invalid data type for Tensor constructor. Expected an array of values or a json object with a 'data' property.");var d=n;if(s=d.dtype?(0,f.getDtype)(d.dtype):s,i=i||d.requiresGrad,d.data instanceof Array){c=(0,h.newTypedArrayFromArray)(d.data,s,u);a._storage=c.storage,a._dtype=s,a._shape=c.shape,a._strides=c.strides}else{if(!(d.data instanceof h.UntypedStorage))throw new Error("Cannot create tensor from json data "+d);if(a._storage=d.data,a._dtype=s,void 0===d.shape&&void 0===d.strides)throw new Error("Cannot create tensor from storage without also specifying the shape and strides.");a._shape=d.shape||[],a._strides=d.strides||(0,l.defaultStrides)(a._shape)}}return a._device=u,a._requiresGrad=i||!1,a._gradFunc=null,a._gradCtx=null,a.grad=null,a}return i(Tensor,e),Object.defineProperty(Tensor.prototype,"storage",{get:function(){return this._storage},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"dtype",{get:function(){return this._dtype},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"shape",{get:function(){return this._shape},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"strides",{get:function(){return this._strides},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"device",{get:function(){return this._device},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"isContiguous",{get:function(){for(var e=this.strides,n=this.shape,r=1,o=n.length-1;o>=0;o--){if(e[o]!==r)return!1;r*=n[o]}return!0},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"isScalar",{get:function(){return 0===this.shape.length||1===this.shape.length&&1===this.shape[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"requiresGrad",{get:function(){return this._requiresGrad},set:function(e){if(this._gradFunc)throw new Error("You can only change requiresGrad flags of leaf variables. If you want to use a computed variable in a subgraph that doesn't require differentiation use valueNoGrad = value.detach().");this._requiresGrad=e},enumerable:!1,configurable:!0}),Object.defineProperty(Tensor.prototype,"gradFunc",{get:function(){return this._gradFunc},enumerable:!1,configurable:!0}),Tensor.prototype.withShape=function(e,n){if((0,l.shapeSize)(e)!=(0,l.shapeSize)(this.shape))throw new Error("Cannot reshape tensor of size ".concat(this.shape," to ").concat(e));return new Tensor({data:this.storage,dtype:this.dtype,device:this.device,requiresGrad:this.requiresGrad,shape:e,strides:n})},Object.defineProperty(Tensor.prototype,Symbol.toStringTag,{get:function(){return"Tensor"},enumerable:!1,configurable:!0}),Tensor.prototype.toString=function(){var e=this.requiresGrad?", requiresGrad=true":"";return this._gradFunc&&(e=", gradFunc"),"tensor([".concat(this.shape,"], ").concat(this.dtype).concat(e,")")},Tensor.prototype.toArrayAsync=function(){return a(this,void 0,void 0,(function(){function readArray(o){var i=o.length;if(i==n.length-1){var a=o.reduce((function(e,n,o){return e+n*r[o]}),0),u=n[i],s=e.subarray(a,a+u);return Array.from(s)}for(var c=[],p=0;p<n[i];p++)o.push(p),c.push(readArray(o)),o.pop();return c}var e,n,r;return u(this,(function(o){switch(o.label){case 0:return[4,this.storage.mapReadAsync()];case 1:return o.sent(),e=this.storage.getTypedArray(this.dtype),n=this.shape,r=this.strides,0==n.length||1==n.length&&1==n[0]?[2,[e[0]]]:[2,readArray([])]}}))}))},Tensor.prototype.runKernelInplace=function(e,n,r){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];if(this.requiresGrad)throw new Error("A tensor that requires a gradient cannot be used in an in-place operation");var a=this.device,u=this.device.getKernel(e,n),s=o.map((function(e){return a.getBufferForKernel(e.storage,e.dtype)})),c=[a.getBufferForKernel(this.storage,this.dtype)];return u.run(s,r,c),this},Tensor.prototype.runKernel=function(e,n,r,o){for(var i=this,a=[],u=4;u<arguments.length;u++)a[u-4]=arguments[u];var p=this.device,d=p.getKernel(e,n),f=c([p.getBufferForKernel(this.storage,this.dtype)],s(a.map((function(e){return p.getBufferForKernel(e.storage,e.dtype)}))),!1),h=d.run(f,r);if(h.length!==o.length)throw new Error("Expected ".concat(o.length," output buffers (given the provided outputShapes to runKernel), but got ").concat(h.length,' output buffers when running the kernel "').concat(e,'".'));return h.map((function(e,n){return new Tensor({data:i.device.getStorageFromKernel(e),dtype:i.dtype,shape:o[n],strides:(0,l.defaultStrides)(o[n]),device:i.device})}))},Tensor.prototype.detach=function(){return this._requiresGrad||this._gradFunc?new Tensor({data:this.storage,dtype:this.dtype,requiresGrad:!1,shape:this.shape,strides:this.strides,device:this.device}):this},Tensor.prototype.setGradientFunction=function(e,n){this._gradFunc=n,this._gradCtx=e,this._requiresGrad=!0},Tensor.prototype.backward=function(e){if(!this.requiresGrad)throw new Error("Cannot call backward on a tensor that does not require gradients");var n;if(e)n=e;else{if(!this.isScalar)throw new Error("Gradient can only be implicitly created for scalar outputs");n=(0,d.ones)(1)}if(this.grad?this.grad.add_(n):this.grad=n,this._gradFunc&&this._gradCtx)for(var r=this._gradFunc(this._gradCtx,n),o=this._gradCtx.inputsWithGradient,i=0;i<o.length;i++){var a=o[i];if(null!==a){var u=r[i];if(!u)throw new Error("Gradient function did not return a gradient for input #".concat(i," (out of ").concat(o.length,"). ").concat(r.length," gradients were returned."));a.backward(u)}}},Tensor.prototype.expand=function(e){for(var n=e.slice(),r=Array(n.length).fill(0),o=n.length-1,i=this.shape,a=this.strides,u=i.length-1;u>=0;u--)1===i[u]?r[o]=0:(r[o]=a[u],o--),-1===n[o]&&(n[o]=i[u]);return this.withShape(n,r)},Tensor.prototype.mm=function(e){return v.mm(this,e)},Tensor.prototype.t=function(){return v.t(this)},Tensor.prototype.zero_=function(){throw new Error("Tensor zero_ is not implemented")},Tensor.prototype.abs=function(){return y.abs(this)},Tensor.prototype.absolute=function(){return y.abs(this)},Tensor.prototype.abs_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("abs_",{dtype:this.dtype},e)},Tensor.prototype.acos=function(){return y.acos(this)},Tensor.prototype.arccos=function(){return y.acos(this)},Tensor.prototype.acos_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("acos_",{dtype:this.dtype},e)},Tensor.prototype.acosh=function(){return y.acosh(this)},Tensor.prototype.arccosh=function(){return y.acosh(this)},Tensor.prototype.acosh_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("acosh_",{dtype:this.dtype},e)},Tensor.prototype.add=function(e,n){return y.add(this,e,n)},Tensor.prototype.add_=function(e,n){var r={size:(0,l.shapeSize)(this.shape),alpha:n||1};return this.runKernelInplace("add_",{dtype:this.dtype},r,e)},Tensor.prototype.asin=function(){return y.asin(this)},Tensor.prototype.arcsin=function(){return y.asin(this)},Tensor.prototype.asin_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("asin_",{dtype:this.dtype},e)},Tensor.prototype.asinh=function(){return y.asinh(this)},Tensor.prototype.arcsinh=function(){return y.asinh(this)},Tensor.prototype.asinh_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("asinh_",{dtype:this.dtype},e)},Tensor.prototype.atan=function(){return y.atan(this)},Tensor.prototype.arctan=function(){return y.atan(this)},Tensor.prototype.atan_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("atan_",{dtype:this.dtype},e)},Tensor.prototype.atan2=function(e){return y.atan2(this,e)},Tensor.prototype.arctan2=function(e){return y.atan2(this,e)},Tensor.prototype.atan2_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("atan2_",{dtype:this.dtype},n,e)},Tensor.prototype.ceil=function(){return y.ceil(this)},Tensor.prototype.ceil_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("ceil_",{dtype:this.dtype},e)},Tensor.prototype.copysign=function(e){return y.copysign(this,e)},Tensor.prototype.copysign_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("copysign_",{dtype:this.dtype},n,e)},Tensor.prototype.cos=function(){return y.cos(this)},Tensor.prototype.cos_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("cos_",{dtype:this.dtype},e)},Tensor.prototype.cosh=function(){return y.cosh(this)},Tensor.prototype.cosh_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("cosh_",{dtype:this.dtype},e)},Tensor.prototype.deg2rad=function(){return y.deg2rad(this)},Tensor.prototype.deg2rad_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("deg2rad_",{dtype:this.dtype},e)},Tensor.prototype.div=function(e,n){return y.div(this,e,n)},Tensor.prototype.divide=function(e,n){return y.div(this,e,n)},Tensor.prototype.div_=function(e,n){var r={size:(0,l.shapeSize)(this.shape),alpha:n||1};return this.runKernelInplace("div_",{dtype:this.dtype},r,e)},Tensor.prototype.exp=function(){return y.exp(this)},Tensor.prototype.exp_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("exp_",{dtype:this.dtype},e)},Tensor.prototype.exp2=function(){return y.exp2(this)},Tensor.prototype.exp2_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("exp2_",{dtype:this.dtype},e)},Tensor.prototype.expm1=function(){return y.expm1(this)},Tensor.prototype.expm1_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("expm1_",{dtype:this.dtype},e)},Tensor.prototype.floor=function(){return y.floor(this)},Tensor.prototype.floor_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("floor_",{dtype:this.dtype},e)},Tensor.prototype.frac=function(){return y.frac(this)},Tensor.prototype.frac_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("frac_",{dtype:this.dtype},e)},Tensor.prototype.hypot=function(e){return y.hypot(this,e)},Tensor.prototype.hypot_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("hypot_",{dtype:this.dtype},n,e)},Tensor.prototype.ldexp=function(e){return y.ldexp(this,e)},Tensor.prototype.ldexp_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("ldexp_",{dtype:this.dtype},n,e)},Tensor.prototype.log=function(){return y.log(this)},Tensor.prototype.log_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("log_",{dtype:this.dtype},e)},Tensor.prototype.log10=function(){return y.log10(this)},Tensor.prototype.log10_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("log10_",{dtype:this.dtype},e)},Tensor.prototype.log1p=function(){return y.log1p(this)},Tensor.prototype.log1p_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("log1p_",{dtype:this.dtype},e)},Tensor.prototype.log2=function(){return y.log2(this)},Tensor.prototype.log2_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("log2_",{dtype:this.dtype},e)},Tensor.prototype.logaddexp=function(e){return y.logaddexp(this,e)},Tensor.prototype.logaddexp_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("logaddexp_",{dtype:this.dtype},n,e)},Tensor.prototype.logaddexp2=function(e){return y.logaddexp2(this,e)},Tensor.prototype.logaddexp2_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("logaddexp2_",{dtype:this.dtype},n,e)},Tensor.prototype.mul=function(e,n){return y.mul(this,e,n)},Tensor.prototype.multiply=function(e,n){return y.mul(this,e,n)},Tensor.prototype.mul_=function(e,n){var r={size:(0,l.shapeSize)(this.shape),alpha:n||1};return this.runKernelInplace("mul_",{dtype:this.dtype},r,e)},Tensor.prototype.neg=function(){return y.neg(this)},Tensor.prototype.negative=function(){return y.neg(this)},Tensor.prototype.neg_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("neg_",{dtype:this.dtype},e)},Tensor.prototype.positive=function(){return y.positive(this)},Tensor.prototype.positive_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("positive_",{dtype:this.dtype},e)},Tensor.prototype.pow=function(e){return y.pow(this,e)},Tensor.prototype.pow_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("pow_",{dtype:this.dtype},n,e)},Tensor.prototype.rad2deg=function(){return y.rad2deg(this)},Tensor.prototype.rad2deg_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("rad2deg_",{dtype:this.dtype},e)},Tensor.prototype.reciprocal=function(){return y.reciprocal(this)},Tensor.prototype.reciprocal_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("reciprocal_",{dtype:this.dtype},e)},Tensor.prototype.relu=function(){return y.relu(this)},Tensor.prototype.relu_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("relu_",{dtype:this.dtype},e)},Tensor.prototype.round=function(){return y.round(this)},Tensor.prototype.round_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("round_",{dtype:this.dtype},e)},Tensor.prototype.rsqrt=function(){return y.rsqrt(this)},Tensor.prototype.rsqrt_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("rsqrt_",{dtype:this.dtype},e)},Tensor.prototype.sigmoid=function(){return y.sigmoid(this)},Tensor.prototype.sigmoid_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sigmoid_",{dtype:this.dtype},e)},Tensor.prototype.sign=function(){return y.sign(this)},Tensor.prototype.sign_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sign_",{dtype:this.dtype},e)},Tensor.prototype.silu=function(){return y.silu(this)},Tensor.prototype.silu_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("silu_",{dtype:this.dtype},e)},Tensor.prototype.sin=function(){return y.sin(this)},Tensor.prototype.sin_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sin_",{dtype:this.dtype},e)},Tensor.prototype.sinc=function(){return y.sinc(this)},Tensor.prototype.sinc_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sinc_",{dtype:this.dtype},e)},Tensor.prototype.sinh=function(){return y.sinh(this)},Tensor.prototype.sinh_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sinh_",{dtype:this.dtype},e)},Tensor.prototype.sqrt=function(){return y.sqrt(this)},Tensor.prototype.sqrt_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("sqrt_",{dtype:this.dtype},e)},Tensor.prototype.square=function(){return y.square(this)},Tensor.prototype.square_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("square_",{dtype:this.dtype},e)},Tensor.prototype.sub=function(e,n){return y.sub(this,e,n)},Tensor.prototype.subtract=function(e,n){return y.sub(this,e,n)},Tensor.prototype.sub_=function(e,n){var r={size:(0,l.shapeSize)(this.shape),alpha:n||1};return this.runKernelInplace("sub_",{dtype:this.dtype},r,e)},Tensor.prototype.tan=function(){return y.tan(this)},Tensor.prototype.tan_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("tan_",{dtype:this.dtype},e)},Tensor.prototype.tanh=function(){return y.tanh(this)},Tensor.prototype.tanh_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("tanh_",{dtype:this.dtype},e)},Tensor.prototype.trunc=function(){return y.trunc(this)},Tensor.prototype.fix=function(){return y.trunc(this)},Tensor.prototype.trunc_=function(){var e={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("trunc_",{dtype:this.dtype},e)},Tensor.prototype.xlogy=function(e){return y.xlogy(this,e)},Tensor.prototype.xlogy_=function(e){var n={size:(0,l.shapeSize)(this.shape)};return this.runKernelInplace("xlogy_",{dtype:this.dtype},n,e)},Tensor.prototype.all=function(e,n){return y.all(this)},Tensor.prototype.any=function(e,n){return y.any(this)},Tensor.prototype.mean=function(e,n){return y.mean(this)},Tensor.prototype.norm=function(e,n){return y.norm(this)},Tensor.prototype.prod=function(e,n){return y.prod(this)},Tensor.prototype.sum=function(e,n){return y.sum(this)},Tensor.prototype.countNonzero=function(e,n){return y.countNonzero(this)},Tensor}(r(283).TensorBase);n.Tensor=g},283:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TensorBase=void 0;var r=function r(){};n.TensorBase=r},889:function(e,n,r){var o=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=Promise))((function(i,a){function fulfilled(e){try{step(o.next(e))}catch(e){a(e)}}function rejected(e){try{step(o.throw(e))}catch(e){a(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(n){n(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(s){return function(c){return function step(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(e,u)}catch(e){s=[6,e],o=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.initWebGPUAsync=n.hasWebGPU=void 0;var a=r(233);n.hasWebGPU=function hasWebGPU(){return!!navigator.gpu},n.initWebGPUAsync=function initWebGPUAsync(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,(0,a.discoverWebGPUDevicesAsync)()];case 1:return[2,e.sent()]}}))}))}}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}var __webpack_exports__=__webpack_require__(607);return __webpack_exports__})()));
//# sourceMappingURL=torch.js.map